{"version":3,"file":"CounterInput.web.js","sources":["../../../../../../src/components/CounterInput/CounterInput.web.tsx"],"sourcesContent":["import React, { useCallback, useState, useEffect, useRef } from 'react';\nimport styled from 'styled-components';\nimport type { CounterInputProps } from './types';\nimport { StyledCounterInput } from './StyledCounterInput';\nimport { COUNTER_INPUT_TOKEN } from './token';\nimport { CounterInputProvider } from './CounterInputContext';\nimport { BaseInput } from '~components/Input/BaseInput';\nimport { metaAttribute, MetaConstants } from '~utils/metaAttribute';\nimport { getStyledProps } from '~components/Box/styledProps';\nimport { assignWithoutSideEffects } from '~utils/assignWithoutSideEffects';\nimport { makeAnalyticsAttribute } from '~utils/makeAnalyticsAttribute';\nimport type { BladeElementRef } from '~utils/types';\nimport { useControllableState } from '~utils/useControllable';\nimport { getOuterMotionRef } from '~utils/getMotionRefs';\nimport BaseBox from '~components/Box/BaseBox';\nimport { FormLabel } from '~components/Form';\nimport { useFormId } from '~components/Form/useFormId';\nimport { useId } from '~utils/useId';\nimport { useTheme } from '~components/BladeProvider';\nimport { useBreakpoint, makeSpace, castWebType, makeMotionTime } from '~utils';\nimport { MinusIcon, PlusIcon } from '~components/Icons';\nimport { ProgressBar } from '~components/ProgressBar';\nimport get from '~utils/lodashButBetter/get';\nimport { mergeRefs } from '~utils/useMergeRefs';\nimport { getFocusRingStyles } from '~utils/getFocusRingStyles';\n\nconst StyledCounterButton = styled.button<{\n  disabled?: boolean;\n  $padding: number;\n  $margin: readonly number[];\n  $emphasis: 'subtle' | 'intense';\n}>`\n  background-color: transparent;\n  border: none;\n  cursor: ${(props) => (props.disabled ? 'not-allowed' : 'pointer')};\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: ${({ theme }) => theme.border.radius.small}px;\n  padding: ${({ $padding }) => makeSpace($padding)};\n  margin: ${({ $margin }) => $margin.map((m) => makeSpace(m)).join(' ')};\n\n  /* Transitions for smooth hover effects */\n  transition-property: background-color, color;\n  transition-duration: ${({ theme }) =>\n    castWebType(makeMotionTime(get(theme.motion, 'duration.xquick')))};\n  transition-timing-function: ${({ theme }) => get(theme.motion, 'easing.standard')};\n\n  &:focus-visible {\n    ${({ theme }) => getFocusRingStyles({ theme, negativeOffset: true })}\n  }\n\n  /* Hover styles based on emphasis */\n  &:hover:not(:disabled) {\n    ${({ theme, $emphasis }) => {\n      if ($emphasis === 'subtle') {\n        return `\n          background-color: ${theme.colors.interactive.background.gray.fadedHighlighted} !important;\n          color: ${theme.colors.interactive.icon.gray.normal} !important;\n        `;\n      } else {\n        return `\n          background-color: ${theme.colors.interactive.background.primary.fadedHighlighted} !important;\n          color: ${theme.colors.interactive.icon.primary.normal} !important;\n        `;\n      }\n    }}\n  }\n`;\n\n// Icon size mapping for counter input\nconst ICON_SIZE_MAP = {\n  xsmall: 'small',\n  small: 'small',\n  medium: 'large',\n  large: 'xlarge',\n} as const;\n\nconst _CounterInput = React.forwardRef<BladeElementRef, CounterInputProps>(\n  (\n    {\n      label,\n      accessibilityLabel,\n      labelPosition = 'top',\n      name,\n      value,\n      defaultValue,\n      min = 0,\n      max,\n      emphasis = 'subtle',\n      size = 'medium',\n      isLoading = false,\n      isDisabled = false,\n      onChange,\n      onFocus,\n      onBlur,\n      testID,\n      _motionMeta,\n      ...rest\n    },\n    ref,\n  ) => {\n    const [internalValue, setInternalValue] = useControllableState({\n      value,\n      defaultValue,\n      onChange: (newValue) => onChange?.({ value: newValue }),\n    });\n\n    const { inputId } = useFormId('counter-input');\n    const idBase = useId('counter-input');\n    const labelId = `${idBase}-label`;\n    const { theme } = useTheme();\n    const { matchedDeviceType } = useBreakpoint({ breakpoints: theme.breakpoints });\n    const isLabelLeftPositioned = labelPosition === 'left' && matchedDeviceType === 'desktop';\n    const emphasisTokens = COUNTER_INPUT_TOKEN.emphasis[emphasis];\n    const _isDisabled = isDisabled || isLoading;\n    const [animationClass, setAnimationClass] = useState('');\n    const lastActionRef = useRef<'increment' | 'decrement' | null>(null);\n    const previousValueRef = useRef<number | undefined>(internalValue);\n    const containerRef = useRef<HTMLDivElement>(null);\n\n    // Track Tab navigation to show focus ring only on keyboard navigation (not mouse clicks)\n    // Note: :focus-visible doesn't work for text inputs - shows ring on both Tab and click\n    // TODO: Re-evaluate and remove later once focus style is unified from design\n    useEffect(() => {\n      const container = containerRef.current;\n      if (!container) return undefined;\n\n      const handleTabKey = (event: KeyboardEvent): void => {\n        if (event.key === 'Tab') {\n          container.classList.add('counter-input-keyboard-focus');\n        }\n      };\n\n      const handleMouseDown = (): void => {\n        container.classList.remove('counter-input-keyboard-focus');\n      };\n\n      document.addEventListener('keydown', handleTabKey, true);\n      document.addEventListener('mousedown', handleMouseDown, true);\n\n      return (): void => {\n        document.removeEventListener('keydown', handleTabKey, true);\n        document.removeEventListener('mousedown', handleMouseDown, true);\n      };\n    }, []);\n\n    // Animation effect - triggers only when value actually changes\n    useEffect(() => {\n      // Only animate if:\n      // 1. We have a stored action (button was clicked)\n      // 2. Value actually changed from previous value\n      // 3. Not currently loading\n      if (lastActionRef.current && !isLoading && internalValue !== previousValueRef.current) {\n        const animationClass =\n          lastActionRef.current === 'increment'\n            ? '__blade-counter-input-animate-slide-up'\n            : '__blade-counter-input-animate-slide-down';\n        setAnimationClass(animationClass);\n        setTimeout(() => setAnimationClass(''), 300);\n        lastActionRef.current = null;\n      }\n\n      previousValueRef.current = internalValue;\n    }, [internalValue, isLoading]);\n\n    const handleInputChange = useCallback(\n      ({ value: inputValue }: { value?: string }) => {\n        const numericValue = inputValue ? parseInt(inputValue, 10) : min;\n        const validValue = isNaN(numericValue) ? min : numericValue;\n\n        let constrainedValue = validValue;\n        if (constrainedValue < min) constrainedValue = min;\n        if (max !== undefined && constrainedValue > max) constrainedValue = max;\n        setInternalValue(() => constrainedValue);\n      },\n      [min, max, onChange, name],\n    );\n\n    const handleIncrement = useCallback(() => {\n      if (_isDisabled) return;\n\n      const newValue = (internalValue ?? min) + 1;\n      const constrainedValue = max !== undefined ? Math.min(newValue, max) : newValue;\n\n      lastActionRef.current = 'increment';\n      setInternalValue(() => constrainedValue);\n    }, [internalValue, min, max, _isDisabled, setInternalValue]);\n\n    const handleDecrement = useCallback(() => {\n      if (_isDisabled) return;\n\n      const newValue = (internalValue ?? min) - 1;\n      const constrainedValue = Math.max(newValue, min);\n\n      lastActionRef.current = 'decrement';\n      setInternalValue(() => constrainedValue);\n    }, [internalValue, min, _isDisabled, setInternalValue]);\n\n    const isDecrementDisabled = _isDisabled || (internalValue ?? min) <= min;\n    const isIncrementDisabled = _isDisabled || (max !== undefined && (internalValue ?? min) >= max);\n\n    const contextValue = {\n      size,\n      emphasis,\n      isDisabled,\n      isLoading,\n      color: emphasisTokens.color,\n      disabledTextColor: emphasisTokens.disabledColor,\n      isInsideCounterInput: true,\n    };\n\n    return (\n      <CounterInputProvider value={contextValue}>\n        {/* __blade-counter-input: CSS selector for animations and component-specific styles */}\n        <StyledCounterInput\n          className=\"__blade-counter-input\"\n          data-emphasis={emphasis}\n          ref={mergeRefs(getOuterMotionRef({ _motionMeta, ref }), containerRef)}\n          {...metaAttribute({ name: MetaConstants.CounterInput, testID })}\n          {...getStyledProps(rest)}\n          {...makeAnalyticsAttribute(rest)}\n        >\n          <BaseBox\n            display=\"flex\"\n            flexDirection={isLabelLeftPositioned ? 'row' : 'column'}\n            alignItems={isLabelLeftPositioned ? 'center' : undefined}\n          >\n            {label && (\n              <FormLabel\n                as=\"label\"\n                position={labelPosition}\n                id={labelId}\n                htmlFor={inputId}\n                size={size}\n              >\n                {label}\n              </FormLabel>\n            )}\n\n            <BaseBox\n              display=\"flex\"\n              position=\"relative\"\n              alignItems=\"center\"\n              flexDirection=\"column\"\n              backgroundColor={\n                isLoading || isDisabled\n                  ? emphasisTokens.loadingOrDisabledBgColor\n                  : emphasisTokens.backgroundColor\n              }\n              width={`${COUNTER_INPUT_TOKEN.width[size]}px`}\n              height={`${COUNTER_INPUT_TOKEN.height[size]}px`}\n              borderRadius=\"medium\"\n              borderWidth=\"thin\"\n              borderColor={\n                _isDisabled ? emphasisTokens.disabledBorderColor : emphasisTokens.borderColor\n              }\n            >\n              <BaseBox display=\"flex\" alignItems=\"center\" flexDirection=\"row\">\n                <StyledCounterButton\n                  className=\"__blade-counter-input-decrement-button\"\n                  onClick={handleDecrement}\n                  $padding={COUNTER_INPUT_TOKEN.iconPadding[size]}\n                  $margin={COUNTER_INPUT_TOKEN.decrementIconMargin}\n                  $emphasis={emphasis}\n                  aria-label=\"Decrement value\"\n                  disabled={isDecrementDisabled}\n                  style={{\n                    color: isDecrementDisabled\n                      ? get(theme.colors, emphasisTokens.disabledIconColor, '')\n                      : get(theme.colors, emphasisTokens.iconColor, ''),\n                  }}\n                >\n                  {/* Using currentColor allows CSS hover styles to control icon color */}\n                  <MinusIcon size={ICON_SIZE_MAP[size]} color=\"currentColor\" />\n                </StyledCounterButton>\n\n                <BaseBox className={animationClass}>\n                  <BaseInput\n                    ref={ref}\n                    id={inputId}\n                    as=\"input\"\n                    name={name}\n                    type=\"number\"\n                    componentName={MetaConstants.CounterInput}\n                    label=\"\"\n                    accessibilityLabel={accessibilityLabel}\n                    value={internalValue?.toString() ?? ''}\n                    onChange={handleInputChange}\n                    onFocus={onFocus}\n                    onBlur={onBlur}\n                    isDisabled={isDisabled}\n                    size={size}\n                    textAlign=\"center\"\n                    // Accessibility attributes for spinbutton\n                    role=\"spinbutton\"\n                    aria-valuemin={min}\n                    aria-valuemax={max}\n                    aria-valuenow={internalValue ?? min}\n                  />\n                </BaseBox>\n\n                <StyledCounterButton\n                  className=\"__blade-counter-input-increment-button\"\n                  onClick={handleIncrement}\n                  $padding={COUNTER_INPUT_TOKEN.iconPadding[size]}\n                  $margin={COUNTER_INPUT_TOKEN.incrementIconMargin}\n                  $emphasis={emphasis}\n                  aria-label=\"Increment value\"\n                  disabled={isIncrementDisabled}\n                  style={{\n                    color: isIncrementDisabled\n                      ? get(theme.colors, emphasisTokens.disabledIconColor, '')\n                      : get(theme.colors, emphasisTokens.iconColor, ''),\n                  }}\n                >\n                  {/* Using currentColor allows CSS hover styles to control icon color */}\n                  <PlusIcon size={ICON_SIZE_MAP[size]} color=\"currentColor\" />\n                </StyledCounterButton>\n              </BaseBox>\n              {isLoading && (\n                <BaseBox width=\"100%\" position=\"absolute\" bottom=\"spacing.0\">\n                  <ProgressBar\n                    color={emphasisTokens.progressBarColor}\n                    showPercentage={false}\n                    value={1}\n                    isIndeterminate={true}\n                    _oscillation={true}\n                  />\n                </BaseBox>\n              )}\n            </BaseBox>\n          </BaseBox>\n        </StyledCounterInput>\n      </CounterInputProvider>\n    );\n  },\n);\n\nconst CounterInput = assignWithoutSideEffects(_CounterInput, {\n  componentId: MetaConstants.CounterInput,\n});\n\nexport { CounterInput };\n"],"names":["StyledCounterButton","styled","button","withConfig","displayName","componentId","props","disabled","_ref","theme","border","radius","small","_ref2","$padding","makeSpace","_ref3","$margin","map","m","join","_ref4","castWebType","makeMotionTime","get","motion","_ref5","_ref6","getFocusRingStyles","negativeOffset","_ref7","$emphasis","concat","colors","interactive","background","gray","fadedHighlighted","icon","normal","primary","ICON_SIZE_MAP","xsmall","medium","large","_CounterInput","React","forwardRef","_ref8","ref","_internalValue$toStri","label","accessibilityLabel","_ref8$labelPosition","labelPosition","name","value","defaultValue","_ref8$min","min","max","_ref8$emphasis","emphasis","_ref8$size","size","_ref8$isLoading","isLoading","_ref8$isDisabled","isDisabled","onChange","onFocus","onBlur","testID","_motionMeta","rest","_objectWithoutProperties","_excluded","_useControllableState","useControllableState","newValue","_useControllableState2","_slicedToArray","internalValue","setInternalValue","_useFormId","useFormId","inputId","idBase","useId","labelId","_useTheme","useTheme","_useBreakpoint","useBreakpoint","breakpoints","matchedDeviceType","isLabelLeftPositioned","emphasisTokens","COUNTER_INPUT_TOKEN","_isDisabled","_useState","useState","_useState2","animationClass","setAnimationClass","lastActionRef","useRef","previousValueRef","containerRef","useEffect","container","current","undefined","handleTabKey","event","key","classList","add","handleMouseDown","remove","document","addEventListener","removeEventListener","setTimeout","handleInputChange","useCallback","_ref9","inputValue","numericValue","parseInt","validValue","isNaN","constrainedValue","handleIncrement","Math","handleDecrement","isDecrementDisabled","isIncrementDisabled","contextValue","color","disabledTextColor","disabledColor","isInsideCounterInput","_jsx","CounterInputProvider","children","StyledCounterInput","_objectSpread","className","mergeRefs","getOuterMotionRef","metaAttribute","MetaConstants","CounterInput","getStyledProps","makeAnalyticsAttribute","_jsxs","BaseBox","display","flexDirection","alignItems","FormLabel","as","position","id","htmlFor","backgroundColor","loadingOrDisabledBgColor","width","height","borderRadius","borderWidth","borderColor","disabledBorderColor","onClick","iconPadding","decrementIconMargin","style","disabledIconColor","iconColor","MinusIcon","BaseInput","type","componentName","toString","textAlign","role","incrementIconMargin","PlusIcon","bottom","ProgressBar","progressBarColor","showPercentage","isIndeterminate","_oscillation","assignWithoutSideEffects"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA,IAAMA,mBAAmB,gBAAGC,MAAM,CAACC,MAAM,CAAAC,UAAA,CAAA;EAAAC,WAAA,EAAA,sCAAA;EAAAC,WAAA,EAAA,UAAA;AAAA,CAAA,CAAA,CAAA,CAAA,kDAAA,EAAA,wEAAA,EAAA,aAAA,EAAA,UAAA,EAAA,kEAAA,EAAA,8BAAA,EAAA,mBAAA,EAAA,0BAAA,EAAA,GAAA,CAAA,EAQ7B,UAACC,KAAK,EAAA;AAAA,EAAA,OAAMA,KAAK,CAACC,QAAQ,GAAG,aAAa,GAAG,SAAS,CAAA;AAAA,CAAC,EAIhD,UAAAC,IAAA,EAAA;AAAA,EAAA,IAAGC,KAAK,GAAAD,IAAA,CAALC,KAAK,CAAA;AAAA,EAAA,OAAOA,KAAK,CAACC,MAAM,CAACC,MAAM,CAACC,KAAK,CAAA;AAAA,CAAA,EAC9C,UAAAC,KAAA,EAAA;AAAA,EAAA,IAAGC,QAAQ,GAAAD,KAAA,CAARC,QAAQ,CAAA;EAAA,OAAOC,SAAS,CAACD,QAAQ,CAAC,CAAA;AAAA,CAAA,EACtC,UAAAE,KAAA,EAAA;AAAA,EAAA,IAAGC,OAAO,GAAAD,KAAA,CAAPC,OAAO,CAAA;AAAA,EAAA,OAAOA,OAAO,CAACC,GAAG,CAAC,UAACC,CAAC,EAAA;IAAA,OAAKJ,SAAS,CAACI,CAAC,CAAC,CAAA;AAAA,GAAA,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC,CAAA;AAAA,CAAA,EAI9C,UAAAC,KAAA,EAAA;AAAA,EAAA,IAAGZ,KAAK,GAAAY,KAAA,CAALZ,KAAK,CAAA;AAAA,EAAA,OAC7Ba,WAAW,CAACC,cAAc,CAACC,KAAG,CAACf,KAAK,CAACgB,MAAM,EAAE,iBAAiB,CAAC,CAAC,CAAC,CAAA;AAAA,CAAA,EACrC,UAAAC,KAAA,EAAA;AAAA,EAAA,IAAGjB,KAAK,GAAAiB,KAAA,CAALjB,KAAK,CAAA;AAAA,EAAA,OAAOe,KAAG,CAACf,KAAK,CAACgB,MAAM,EAAE,iBAAiB,CAAC,CAAA;AAAA,CAAA,EAG7E,UAAAE,KAAA,EAAA;AAAA,EAAA,IAAGlB,KAAK,GAAAkB,KAAA,CAALlB,KAAK,CAAA;AAAA,EAAA,OAAOmB,kBAAkB,CAAC;AAAEnB,IAAAA,KAAK,EAALA,KAAK;AAAEoB,IAAAA,cAAc,EAAE,IAAA;AAAK,GAAC,CAAC,CAAA;AAAA,CAKlE,EAAA,UAAAC,KAAA,EAA0B;AAAA,EAAA,IAAvBrB,KAAK,GAAAqB,KAAA,CAALrB,KAAK;IAAEsB,SAAS,GAAAD,KAAA,CAATC,SAAS,CAAA;EACnB,IAAIA,SAAS,KAAK,QAAQ,EAAE;IAC1B,OAAAC,gCAAAA,CAAAA,MAAA,CACsBvB,KAAK,CAACwB,MAAM,CAACC,WAAW,CAACC,UAAU,CAACC,IAAI,CAACC,gBAAgB,qCAAAL,MAAA,CACpEvB,KAAK,CAACwB,MAAM,CAACC,WAAW,CAACI,IAAI,CAACF,IAAI,CAACG,MAAM,EAAA,wBAAA,CAAA,CAAA;AAEtD,GAAC,MAAM;IACL,OAAAP,gCAAAA,CAAAA,MAAA,CACsBvB,KAAK,CAACwB,MAAM,CAACC,WAAW,CAACC,UAAU,CAACK,OAAO,CAACH,gBAAgB,qCAAAL,MAAA,CACvEvB,KAAK,CAACwB,MAAM,CAACC,WAAW,CAACI,IAAI,CAACE,OAAO,CAACD,MAAM,EAAA,wBAAA,CAAA,CAAA;AAEzD,GAAA;AACF,CAAC,CAEJ,CAAA;;AAED;AACA,IAAME,aAAa,GAAG;AACpBC,EAAAA,MAAM,EAAE,OAAO;AACf9B,EAAAA,KAAK,EAAE,OAAO;AACd+B,EAAAA,MAAM,EAAE,OAAO;AACfC,EAAAA,KAAK,EAAE,QAAA;AACT,CAAU,CAAA;AAEV,IAAMC,aAAa,gBAAGC,cAAK,CAACC,UAAU,CACpC,UAAAC,KAAA,EAqBEC,GAAG,EACA;AAAA,EAAA,IAAAC,qBAAA,CAAA;AAAA,EAAA,IApBDC,KAAK,GAAAH,KAAA,CAALG,KAAK;IACLC,kBAAkB,GAAAJ,KAAA,CAAlBI,kBAAkB;IAAAC,mBAAA,GAAAL,KAAA,CAClBM,aAAa;AAAbA,IAAAA,aAAa,GAAAD,mBAAA,KAAG,KAAA,CAAA,GAAA,KAAK,GAAAA,mBAAA;IACrBE,IAAI,GAAAP,KAAA,CAAJO,IAAI;IACJC,KAAK,GAAAR,KAAA,CAALQ,KAAK;IACLC,YAAY,GAAAT,KAAA,CAAZS,YAAY;IAAAC,SAAA,GAAAV,KAAA,CACZW,GAAG;AAAHA,IAAAA,GAAG,GAAAD,SAAA,KAAG,KAAA,CAAA,GAAA,CAAC,GAAAA,SAAA;IACPE,GAAG,GAAAZ,KAAA,CAAHY,GAAG;IAAAC,cAAA,GAAAb,KAAA,CACHc,QAAQ;AAARA,IAAAA,QAAQ,GAAAD,cAAA,KAAG,KAAA,CAAA,GAAA,QAAQ,GAAAA,cAAA;IAAAE,UAAA,GAAAf,KAAA,CACnBgB,IAAI;AAAJA,IAAAA,IAAI,GAAAD,UAAA,KAAG,KAAA,CAAA,GAAA,QAAQ,GAAAA,UAAA;IAAAE,eAAA,GAAAjB,KAAA,CACfkB,SAAS;AAATA,IAAAA,SAAS,GAAAD,eAAA,KAAG,KAAA,CAAA,GAAA,KAAK,GAAAA,eAAA;IAAAE,gBAAA,GAAAnB,KAAA,CACjBoB,UAAU;AAAVA,IAAAA,UAAU,GAAAD,gBAAA,KAAG,KAAA,CAAA,GAAA,KAAK,GAAAA,gBAAA;IAClBE,SAAQ,GAAArB,KAAA,CAARqB,QAAQ;IACRC,OAAO,GAAAtB,KAAA,CAAPsB,OAAO;IACPC,MAAM,GAAAvB,KAAA,CAANuB,MAAM;IACNC,MAAM,GAAAxB,KAAA,CAANwB,MAAM;IACNC,WAAW,GAAAzB,KAAA,CAAXyB,WAAW;AACRC,IAAAA,IAAI,GAAAC,wBAAA,CAAA3B,KAAA,EAAA4B,SAAA,CAAA,CAAA;EAIT,IAAAC,qBAAA,GAA0CC,oBAAoB,CAAC;AAC7DtB,MAAAA,KAAK,EAALA,KAAK;AACLC,MAAAA,YAAY,EAAZA,YAAY;AACZY,MAAAA,QAAQ,EAAE,SAAVA,QAAQA,CAAGU,QAAQ,EAAA;AAAA,QAAA,OAAKV,SAAQ,KAAA,IAAA,IAARA,SAAQ,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAARA,SAAQ,CAAG;AAAEb,UAAAA,KAAK,EAAEuB,QAAAA;AAAS,SAAC,CAAC,CAAA;AAAA,OAAA;AACzD,KAAC,CAAC;IAAAC,sBAAA,GAAAC,cAAA,CAAAJ,qBAAA,EAAA,CAAA,CAAA;AAJKK,IAAAA,aAAa,GAAAF,sBAAA,CAAA,CAAA,CAAA;AAAEG,IAAAA,gBAAgB,GAAAH,sBAAA,CAAA,CAAA,CAAA,CAAA;AAMtC,EAAA,IAAAI,UAAA,GAAoBC,SAAS,CAAC,eAAe,CAAC;IAAtCC,OAAO,GAAAF,UAAA,CAAPE,OAAO,CAAA;AACf,EAAA,IAAMC,MAAM,GAAGC,KAAK,CAAC,eAAe,CAAC,CAAA;AACrC,EAAA,IAAMC,OAAO,GAAA,EAAA,CAAAzD,MAAA,CAAMuD,MAAM,EAAQ,QAAA,CAAA,CAAA;AACjC,EAAA,IAAAG,SAAA,GAAkBC,QAAQ,EAAE;IAApBlF,KAAK,GAAAiF,SAAA,CAALjF,KAAK,CAAA;EACb,IAAAmF,cAAA,GAA8BC,aAAa,CAAC;MAAEC,WAAW,EAAErF,KAAK,CAACqF,WAAAA;AAAY,KAAC,CAAC;IAAvEC,iBAAiB,GAAAH,cAAA,CAAjBG,iBAAiB,CAAA;EACzB,IAAMC,qBAAqB,GAAG1C,aAAa,KAAK,MAAM,IAAIyC,iBAAiB,KAAK,SAAS,CAAA;AACzF,EAAA,IAAME,cAAc,GAAGC,mBAAmB,CAACpC,QAAQ,CAACA,QAAQ,CAAC,CAAA;AAC7D,EAAA,IAAMqC,WAAW,GAAG/B,UAAU,IAAIF,SAAS,CAAA;AAC3C,EAAA,IAAAkC,SAAA,GAA4CC,QAAQ,CAAC,EAAE,CAAC;IAAAC,UAAA,GAAArB,cAAA,CAAAmB,SAAA,EAAA,CAAA,CAAA;AAAjDG,IAAAA,cAAc,GAAAD,UAAA,CAAA,CAAA,CAAA;AAAEE,IAAAA,iBAAiB,GAAAF,UAAA,CAAA,CAAA,CAAA,CAAA;AACxC,EAAA,IAAMG,aAAa,GAAGC,MAAM,CAAmC,IAAI,CAAC,CAAA;AACpE,EAAA,IAAMC,gBAAgB,GAAGD,MAAM,CAAqBxB,aAAa,CAAC,CAAA;AAClE,EAAA,IAAM0B,YAAY,GAAGF,MAAM,CAAiB,IAAI,CAAC,CAAA;;AAEjD;AACA;AACA;AACAG,EAAAA,SAAS,CAAC,YAAM;AACd,IAAA,IAAMC,SAAS,GAAGF,YAAY,CAACG,OAAO,CAAA;AACtC,IAAA,IAAI,CAACD,SAAS,EAAE,OAAOE,SAAS,CAAA;AAEhC,IAAA,IAAMC,YAAY,GAAG,SAAfA,YAAYA,CAAIC,KAAoB,EAAW;AACnD,MAAA,IAAIA,KAAK,CAACC,GAAG,KAAK,KAAK,EAAE;AACvBL,QAAAA,SAAS,CAACM,SAAS,CAACC,GAAG,CAAC,8BAA8B,CAAC,CAAA;AACzD,OAAA;KACD,CAAA;AAED,IAAA,IAAMC,eAAe,GAAG,SAAlBA,eAAeA,GAAe;AAClCR,MAAAA,SAAS,CAACM,SAAS,CAACG,MAAM,CAAC,8BAA8B,CAAC,CAAA;KAC3D,CAAA;IAEDC,QAAQ,CAACC,gBAAgB,CAAC,SAAS,EAAER,YAAY,EAAE,IAAI,CAAC,CAAA;IACxDO,QAAQ,CAACC,gBAAgB,CAAC,WAAW,EAAEH,eAAe,EAAE,IAAI,CAAC,CAAA;AAE7D,IAAA,OAAO,YAAY;MACjBE,QAAQ,CAACE,mBAAmB,CAAC,SAAS,EAAET,YAAY,EAAE,IAAI,CAAC,CAAA;MAC3DO,QAAQ,CAACE,mBAAmB,CAAC,WAAW,EAAEJ,eAAe,EAAE,IAAI,CAAC,CAAA;KACjE,CAAA;GACF,EAAE,EAAE,CAAC,CAAA;;AAEN;AACAT,EAAAA,SAAS,CAAC,YAAM;AACd;AACA;AACA;AACA;AACA,IAAA,IAAIJ,aAAa,CAACM,OAAO,IAAI,CAAC7C,SAAS,IAAIgB,aAAa,KAAKyB,gBAAgB,CAACI,OAAO,EAAE;MACrF,IAAMR,eAAc,GAClBE,aAAa,CAACM,OAAO,KAAK,WAAW,GACjC,wCAAwC,GACxC,0CAA0C,CAAA;MAChDP,iBAAiB,CAACD,eAAc,CAAC,CAAA;AACjCoB,MAAAA,UAAU,CAAC,YAAA;QAAA,OAAMnB,iBAAiB,CAAC,EAAE,CAAC,CAAA;AAAA,OAAA,EAAE,GAAG,CAAC,CAAA;MAC5CC,aAAa,CAACM,OAAO,GAAG,IAAI,CAAA;AAC9B,KAAA;IAEAJ,gBAAgB,CAACI,OAAO,GAAG7B,aAAa,CAAA;AAC1C,GAAC,EAAE,CAACA,aAAa,EAAEhB,SAAS,CAAC,CAAC,CAAA;AAE9B,EAAA,IAAM0D,iBAAiB,GAAGC,WAAW,CACnC,UAAAC,KAAA,EAA+C;AAAA,IAAA,IAArCC,UAAU,GAAAD,KAAA,CAAjBtE,KAAK,CAAA;IACN,IAAMwE,YAAY,GAAGD,UAAU,GAAGE,QAAQ,CAACF,UAAU,EAAE,EAAE,CAAC,GAAGpE,GAAG,CAAA;IAChE,IAAMuE,UAAU,GAAGC,KAAK,CAACH,YAAY,CAAC,GAAGrE,GAAG,GAAGqE,YAAY,CAAA;IAE3D,IAAII,gBAAgB,GAAGF,UAAU,CAAA;AACjC,IAAA,IAAIE,gBAAgB,GAAGzE,GAAG,EAAEyE,gBAAgB,GAAGzE,GAAG,CAAA;IAClD,IAAIC,GAAG,KAAKoD,SAAS,IAAIoB,gBAAgB,GAAGxE,GAAG,EAAEwE,gBAAgB,GAAGxE,GAAG,CAAA;AACvEuB,IAAAA,gBAAgB,CAAC,YAAA;AAAA,MAAA,OAAMiD,gBAAgB,CAAA;KAAC,CAAA,CAAA;GACzC,EACD,CAACzE,GAAG,EAAEC,GAAG,EAAES,SAAQ,EAAEd,IAAI,CAC3B,CAAC,CAAA;AAED,EAAA,IAAM8E,eAAe,GAAGR,WAAW,CAAC,YAAM;AACxC,IAAA,IAAI1B,WAAW,EAAE,OAAA;IAEjB,IAAMpB,QAAQ,GAAG,CAACG,aAAa,KAAA,IAAA,IAAbA,aAAa,KAAA,KAAA,CAAA,GAAbA,aAAa,GAAIvB,GAAG,IAAI,CAAC,CAAA;AAC3C,IAAA,IAAMyE,gBAAgB,GAAGxE,GAAG,KAAKoD,SAAS,GAAGsB,IAAI,CAAC3E,GAAG,CAACoB,QAAQ,EAAEnB,GAAG,CAAC,GAAGmB,QAAQ,CAAA;IAE/E0B,aAAa,CAACM,OAAO,GAAG,WAAW,CAAA;AACnC5B,IAAAA,gBAAgB,CAAC,YAAA;AAAA,MAAA,OAAMiD,gBAAgB,CAAA;KAAC,CAAA,CAAA;AAC1C,GAAC,EAAE,CAAClD,aAAa,EAAEvB,GAAG,EAAEC,GAAG,EAAEuC,WAAW,EAAEhB,gBAAgB,CAAC,CAAC,CAAA;AAE5D,EAAA,IAAMoD,eAAe,GAAGV,WAAW,CAAC,YAAM;AACxC,IAAA,IAAI1B,WAAW,EAAE,OAAA;IAEjB,IAAMpB,QAAQ,GAAG,CAACG,aAAa,KAAA,IAAA,IAAbA,aAAa,KAAA,KAAA,CAAA,GAAbA,aAAa,GAAIvB,GAAG,IAAI,CAAC,CAAA;IAC3C,IAAMyE,gBAAgB,GAAGE,IAAI,CAAC1E,GAAG,CAACmB,QAAQ,EAAEpB,GAAG,CAAC,CAAA;IAEhD8C,aAAa,CAACM,OAAO,GAAG,WAAW,CAAA;AACnC5B,IAAAA,gBAAgB,CAAC,YAAA;AAAA,MAAA,OAAMiD,gBAAgB,CAAA;KAAC,CAAA,CAAA;GACzC,EAAE,CAAClD,aAAa,EAAEvB,GAAG,EAAEwC,WAAW,EAAEhB,gBAAgB,CAAC,CAAC,CAAA;AAEvD,EAAA,IAAMqD,mBAAmB,GAAGrC,WAAW,IAAI,CAACjB,aAAa,KAAbA,IAAAA,IAAAA,aAAa,KAAbA,KAAAA,CAAAA,GAAAA,aAAa,GAAIvB,GAAG,KAAKA,GAAG,CAAA;AACxE,EAAA,IAAM8E,mBAAmB,GAAGtC,WAAW,IAAKvC,GAAG,KAAKoD,SAAS,IAAI,CAAC9B,aAAa,aAAbA,aAAa,KAAA,KAAA,CAAA,GAAbA,aAAa,GAAIvB,GAAG,KAAKC,GAAI,CAAA;AAE/F,EAAA,IAAM8E,YAAY,GAAG;AACnB1E,IAAAA,IAAI,EAAJA,IAAI;AACJF,IAAAA,QAAQ,EAARA,QAAQ;AACRM,IAAAA,UAAU,EAAVA,UAAU;AACVF,IAAAA,SAAS,EAATA,SAAS;IACTyE,KAAK,EAAE1C,cAAc,CAAC0C,KAAK;IAC3BC,iBAAiB,EAAE3C,cAAc,CAAC4C,aAAa;AAC/CC,IAAAA,oBAAoB,EAAE,IAAA;GACvB,CAAA;EAED,oBACEC,GAAA,CAACC,oBAAoB,EAAA;AAACxF,IAAAA,KAAK,EAAEkF,YAAa;IAAAO,QAAA,eAExCF,GAAA,CAACG,kBAAkB,EAAAC,aAAA,CAAAA,aAAA,CAAAA,aAAA,CAAAA,aAAA,CAAA;AACjBC,MAAAA,SAAS,EAAC,uBAAuB;AACjC,MAAA,eAAA,EAAetF,QAAS;AACxBb,MAAAA,GAAG,EAAEoG,SAAS,CAACC,iBAAiB,CAAC;AAAE7E,QAAAA,WAAW,EAAXA,WAAW;AAAExB,QAAAA,GAAG,EAAHA,GAAAA;OAAK,CAAC,EAAE2D,YAAY,CAAA;AAAE,KAAA,EAClE2C,aAAa,CAAC;MAAEhG,IAAI,EAAEiG,aAAa,CAACC,YAAY;AAAEjF,MAAAA,MAAM,EAANA,MAAAA;KAAQ,CAAC,CAC3DkF,EAAAA,cAAc,CAAChF,IAAI,CAAC,CACpBiF,EAAAA,sBAAsB,CAACjF,IAAI,CAAC,CAAA,EAAA,EAAA,EAAA;MAAAuE,QAAA,eAEhCW,IAAA,CAACC,OAAO,EAAA;AACNC,QAAAA,OAAO,EAAC,MAAM;AACdC,QAAAA,aAAa,EAAE/D,qBAAqB,GAAG,KAAK,GAAG,QAAS;AACxDgE,QAAAA,UAAU,EAAEhE,qBAAqB,GAAG,QAAQ,GAAGgB,SAAU;AAAAiC,QAAAA,QAAA,EAExD9F,CAAAA,KAAK,iBACJ4F,GAAA,CAACkB,SAAS,EAAA;AACRC,UAAAA,EAAE,EAAC,OAAO;AACVC,UAAAA,QAAQ,EAAE7G,aAAc;AACxB8G,UAAAA,EAAE,EAAE3E,OAAQ;AACZ4E,UAAAA,OAAO,EAAE/E,OAAQ;AACjBtB,UAAAA,IAAI,EAAEA,IAAK;AAAAiF,UAAAA,QAAA,EAEV9F,KAAAA;AAAK,SACG,CACZ,eAEDyG,IAAA,CAACC,OAAO,EAAA;AACNC,UAAAA,OAAO,EAAC,MAAM;AACdK,UAAAA,QAAQ,EAAC,UAAU;AACnBH,UAAAA,UAAU,EAAC,QAAQ;AACnBD,UAAAA,aAAa,EAAC,QAAQ;UACtBO,eAAe,EACbpG,SAAS,IAAIE,UAAU,GACnB6B,cAAc,CAACsE,wBAAwB,GACvCtE,cAAc,CAACqE,eACpB;UACDE,KAAK,EAAA,EAAA,CAAAxI,MAAA,CAAKkE,mBAAmB,CAACsE,KAAK,CAACxG,IAAI,CAAC,EAAK,IAAA,CAAA;UAC9CyG,MAAM,EAAA,EAAA,CAAAzI,MAAA,CAAKkE,mBAAmB,CAACuE,MAAM,CAACzG,IAAI,CAAC,EAAK,IAAA,CAAA;AAChD0G,UAAAA,YAAY,EAAC,QAAQ;AACrBC,UAAAA,WAAW,EAAC,MAAM;UAClBC,WAAW,EACTzE,WAAW,GAAGF,cAAc,CAAC4E,mBAAmB,GAAG5E,cAAc,CAAC2E,WACnE;UAAA3B,QAAA,EAAA,cAEDW,IAAA,CAACC,OAAO,EAAA;AAACC,YAAAA,OAAO,EAAC,MAAM;AAACE,YAAAA,UAAU,EAAC,QAAQ;AAACD,YAAAA,aAAa,EAAC,KAAK;YAAAd,QAAA,EAAA,cAC7DF,GAAA,CAAC/I,mBAAmB,EAAA;AAClBoJ,cAAAA,SAAS,EAAC,wCAAwC;AAClD0B,cAAAA,OAAO,EAAEvC,eAAgB;AACzBzH,cAAAA,QAAQ,EAAEoF,mBAAmB,CAAC6E,WAAW,CAAC/G,IAAI,CAAE;cAChD/C,OAAO,EAAEiF,mBAAmB,CAAC8E,mBAAoB;AACjDjJ,cAAAA,SAAS,EAAE+B,QAAS;AACpB,cAAA,YAAA,EAAW,iBAAiB;AAC5BvD,cAAAA,QAAQ,EAAEiI,mBAAoB;AAC9ByC,cAAAA,KAAK,EAAE;gBACLtC,KAAK,EAAEH,mBAAmB,GACtBhH,KAAG,CAACf,KAAK,CAACwB,MAAM,EAAEgE,cAAc,CAACiF,iBAAiB,EAAE,EAAE,CAAC,GACvD1J,KAAG,CAACf,KAAK,CAACwB,MAAM,EAAEgE,cAAc,CAACkF,SAAS,EAAE,EAAE,CAAA;eAClD;cAAAlC,QAAA,eAGFF,GAAA,CAACqC,SAAS,EAAA;AAACpH,gBAAAA,IAAI,EAAEvB,aAAa,CAACuB,IAAI,CAAE;AAAC2E,gBAAAA,KAAK,EAAC,cAAA;eAAgB,CAAA;AAAC,aAC1C,CAAC,eAEtBI,GAAA,CAACc,OAAO,EAAA;AAACT,cAAAA,SAAS,EAAE7C,cAAe;cAAA0C,QAAA,eACjCF,GAAA,CAACsC,SAAS,EAAA;AACRpI,gBAAAA,GAAG,EAAEA,GAAI;AACTmH,gBAAAA,EAAE,EAAE9E,OAAQ;AACZ4E,gBAAAA,EAAE,EAAC,OAAO;AACV3G,gBAAAA,IAAI,EAAEA,IAAK;AACX+H,gBAAAA,IAAI,EAAC,QAAQ;gBACbC,aAAa,EAAE/B,aAAa,CAACC,YAAa;AAC1CtG,gBAAAA,KAAK,EAAC,EAAE;AACRC,gBAAAA,kBAAkB,EAAEA,kBAAmB;AACvCI,gBAAAA,KAAK,GAAAN,qBAAA,GAAEgC,aAAa,KAAA,IAAA,IAAbA,aAAa,KAAbA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,aAAa,CAAEsG,QAAQ,EAAE,MAAA,IAAA,IAAAtI,qBAAA,KAAAA,KAAAA,CAAAA,GAAAA,qBAAA,GAAI,EAAG;AACvCmB,gBAAAA,QAAQ,EAAEuD,iBAAkB;AAC5BtD,gBAAAA,OAAO,EAAEA,OAAQ;AACjBC,gBAAAA,MAAM,EAAEA,MAAO;AACfH,gBAAAA,UAAU,EAAEA,UAAW;AACvBJ,gBAAAA,IAAI,EAAEA,IAAK;AACXyH,gBAAAA,SAAS,EAAC,QAAA;AACV;AAAA;AACAC,gBAAAA,IAAI,EAAC,YAAY;AACjB,gBAAA,eAAA,EAAe/H,GAAI;AACnB,gBAAA,eAAA,EAAeC,GAAI;AACnB,gBAAA,eAAA,EAAesB,aAAa,KAAA,IAAA,IAAbA,aAAa,KAAA,KAAA,CAAA,GAAbA,aAAa,GAAIvB,GAAAA;eACjC,CAAA;AAAC,aACK,CAAC,eAEVoF,GAAA,CAAC/I,mBAAmB,EAAA;AAClBoJ,cAAAA,SAAS,EAAC,wCAAwC;AAClD0B,cAAAA,OAAO,EAAEzC,eAAgB;AACzBvH,cAAAA,QAAQ,EAAEoF,mBAAmB,CAAC6E,WAAW,CAAC/G,IAAI,CAAE;cAChD/C,OAAO,EAAEiF,mBAAmB,CAACyF,mBAAoB;AACjD5J,cAAAA,SAAS,EAAE+B,QAAS;AACpB,cAAA,YAAA,EAAW,iBAAiB;AAC5BvD,cAAAA,QAAQ,EAAEkI,mBAAoB;AAC9BwC,cAAAA,KAAK,EAAE;gBACLtC,KAAK,EAAEF,mBAAmB,GACtBjH,KAAG,CAACf,KAAK,CAACwB,MAAM,EAAEgE,cAAc,CAACiF,iBAAiB,EAAE,EAAE,CAAC,GACvD1J,KAAG,CAACf,KAAK,CAACwB,MAAM,EAAEgE,cAAc,CAACkF,SAAS,EAAE,EAAE,CAAA;eAClD;cAAAlC,QAAA,eAGFF,GAAA,CAAC6C,QAAQ,EAAA;AAAC5H,gBAAAA,IAAI,EAAEvB,aAAa,CAACuB,IAAI,CAAE;AAAC2E,gBAAAA,KAAK,EAAC,cAAA;eAAgB,CAAA;AAAC,aACzC,CAAC,CAAA;AAAA,WACf,CAAC,EACTzE,SAAS,iBACR6E,GAAA,CAACc,OAAO,EAAA;AAACW,YAAAA,KAAK,EAAC,MAAM;AAACL,YAAAA,QAAQ,EAAC,UAAU;AAAC0B,YAAAA,MAAM,EAAC,WAAW;YAAA5C,QAAA,eAC1DF,GAAA,CAAC+C,WAAW,EAAA;cACVnD,KAAK,EAAE1C,cAAc,CAAC8F,gBAAiB;AACvCC,cAAAA,cAAc,EAAE,KAAM;AACtBxI,cAAAA,KAAK,EAAE,CAAE;AACTyI,cAAAA,eAAe,EAAE,IAAK;AACtBC,cAAAA,YAAY,EAAE,IAAA;aACf,CAAA;AAAC,WACK,CACV,CAAA;AAAA,SACM,CAAC,CAAA;OACH,CAAA;KACS,CAAA,CAAA;AAAC,GACD,CAAC,CAAA;AAE3B,CACF,CAAC,CAAA;AAED,IAAMzC,YAAY,gBAAG0C,wBAAwB,CAACtJ,aAAa,EAAE;EAC3DxC,WAAW,EAAEmJ,aAAa,CAACC,YAAAA;AAC7B,CAAC;;;;"}