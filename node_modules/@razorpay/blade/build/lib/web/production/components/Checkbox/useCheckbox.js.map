{"version":3,"file":"useCheckbox.js","sources":["../../../../../../src/components/Checkbox/useCheckbox.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/explicit-function-return-type */\n/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\nimport React from 'react';\nimport type { GestureResponderEvent } from 'react-native';\nimport type { CheckboxProps } from './Checkbox';\nimport { useFormId } from '~components/Form/useFormId';\nimport { makeAccessible } from '~utils/makeAccessible';\nimport { getPlatformType } from '~utils';\nimport { useControllableState } from '~utils/useControllable';\nimport { throwBladeError } from '~utils/logger';\n\ntype UseCheckboxProps = Pick<\n  CheckboxProps,\n  | 'isChecked'\n  | 'defaultChecked'\n  | 'isDisabled'\n  | 'isIndeterminate'\n  | 'isRequired'\n  | 'onChange'\n  | 'name'\n  | 'value'\n> & {\n  role?: 'checkbox' | 'switch';\n  hasError?: boolean;\n  hasHelperText?: boolean;\n};\n\n/**\n * indeterminate is not a HTML input element prop,\n * it's an IDL prop thus we need to set it on the underlying HTMLInputElement\n */\nfunction setMixed(element: HTMLInputElement, mixed?: boolean) {\n  if (mixed) {\n    element.indeterminate = true;\n  } else if (element.indeterminate) {\n    element.indeterminate = false;\n  }\n}\n\nconst useCheckbox = ({\n  role = 'checkbox',\n  isChecked,\n  defaultChecked,\n  isIndeterminate,\n  isDisabled,\n  isRequired,\n  hasError,\n  hasHelperText,\n  onChange,\n  name,\n  value,\n}: UseCheckboxProps) => {\n  const inputRef = React.useRef<HTMLInputElement>(null);\n\n  const isReactNative = getPlatformType() === 'react-native';\n  if (__DEV__) {\n    if (isChecked && defaultChecked) {\n      throwBladeError({\n        message: `Do not provide both 'isChecked' and 'defaultChecked' to useCheckbox. Consider if you want this component to be controlled or uncontrolled.`,\n        moduleName: 'useCheckbox',\n      });\n    }\n  }\n\n  const [checkboxState, setCheckboxStateChange] = useControllableState({\n    value: isChecked,\n    defaultValue: defaultChecked ?? false,\n  });\n\n  const handleOnChange = (event: React.ChangeEvent<HTMLInputElement> | GestureResponderEvent) => {\n    if (isDisabled) {\n      event.stopPropagation();\n      event.preventDefault();\n      return;\n    }\n    setCheckboxStateChange((checked) => {\n      onChange?.({\n        isChecked: !checked,\n        event: event as React.ChangeEvent,\n        value,\n      });\n      return !checked;\n    });\n  };\n\n  // set indeterminate to input\n  React.useEffect(() => {\n    const element = inputRef.current;\n    if (!element) return;\n    setMixed(element, isIndeterminate);\n  }, [isIndeterminate]);\n\n  const state = {\n    isReactNative,\n    isChecked: checkboxState,\n    setChecked: setCheckboxStateChange,\n  };\n\n  const { inputId, errorTextId, helpTextId } = useFormId('checkbox');\n\n  const accessibilityProps = makeAccessible({\n    role,\n    required: Boolean(isRequired),\n    invalid: Boolean(hasError),\n    disabled: Boolean(isDisabled),\n    checked: inputRef.current?.indeterminate ? 'mixed' : checkboxState,\n    ...(hasError ? { errorMessage: errorTextId } : {}),\n    ...(hasHelperText ? { describedBy: helpTextId } : {}),\n  });\n\n  if (isReactNative) {\n    return {\n      state,\n      inputProps: {\n        onPress: handleOnChange,\n        name,\n        value,\n        ...accessibilityProps,\n      },\n    };\n  }\n\n  return {\n    state,\n    ids: { inputId, errorTextId, helpTextId },\n    inputProps: {\n      ref: inputRef,\n      onChange: handleOnChange,\n      type: 'checkbox',\n      name,\n      value,\n      checked: checkboxState,\n      disabled: isDisabled,\n      required: isRequired,\n      ...accessibilityProps,\n    },\n  };\n};\n\nexport type InputProps = ReturnType<typeof useCheckbox>['inputProps'];\n\nexport { useCheckbox };\n"],"names":["setMixed","element","mixed","indeterminate","useCheckbox","_ref","_inputRef$current","_ref$role","role","isChecked","defaultChecked","isIndeterminate","isDisabled","isRequired","hasError","hasHelperText","onChange","name","value","inputRef","React","useRef","isReactNative","getPlatformType","throwBladeError","message","moduleName","_useControllableState","useControllableState","defaultValue","_useControllableState2","_slicedToArray","checkboxState","setCheckboxStateChange","handleOnChange","event","stopPropagation","preventDefault","checked","useEffect","current","state","setChecked","_useFormId","useFormId","inputId","errorTextId","helpTextId","accessibilityProps","makeAccessible","_objectSpread","required","Boolean","invalid","disabled","errorMessage","describedBy","inputProps","onPress","ids","ref","type"],"mappings":"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"}