{"version":3,"file":"utils.js","sources":["../../../../../../../src/components/Charts/CommonChartComponents/utils.ts"],"sourcesContent":["import { MIN_WIDTH, MAX_WIDTH, PADDING_HORIZONTAL } from './tokens';\nimport type { Theme } from '~components/BladeProvider';\n\nconst calculateTextWidth = (text: string, theme: Theme): { width: number; displayText: string } => {\n  // Create a temporary canvas to measure text\n  const canvas = document.createElement('canvas');\n  const context = canvas.getContext('2d');\n  if (!context) return { width: 80, displayText: text }; // fallback\n\n  // Set font properties to match the text styling\n  const fontSize = theme.typography.fonts.size[50];\n  const fontFamily = theme.typography.fonts.family.text;\n  const fontWeight = theme.typography.fonts.weight.medium;\n\n  context.font = `${fontWeight} ${fontSize}px ${fontFamily}`;\n\n  // Measure the full text first\n  const fullTextWidth = context.measureText(text).width;\n  const availableWidth = MAX_WIDTH - PADDING_HORIZONTAL;\n\n  // If text fits within max width, use it as is\n  if (fullTextWidth <= availableWidth) {\n    const finalWidth = Math.max(MIN_WIDTH, fullTextWidth + PADDING_HORIZONTAL);\n    return { width: finalWidth, displayText: text };\n  }\n\n  // Text is too long, need to truncate\n  const ELLIPSIS = '...';\n  const ellipsisWidth = context.measureText(ELLIPSIS).width;\n  const maxTextWidth = availableWidth - ellipsisWidth;\n\n  // Binary search to find the optimal truncation point\n  let left = 0;\n  let right = text.length;\n  let bestFit = '';\n\n  while (left <= right) {\n    const mid = Math.floor((left + right) / 2);\n    const testText = text.substring(0, mid);\n    const testWidth = context.measureText(testText).width;\n\n    if (testWidth <= maxTextWidth) {\n      bestFit = testText;\n      left = mid + 1;\n    } else {\n      right = mid - 1;\n    }\n  }\n\n  const truncatedText = bestFit + ELLIPSIS;\n  const finalWidth = Math.max(MIN_WIDTH, MAX_WIDTH);\n\n  return { width: finalWidth, displayText: truncatedText };\n};\n\nexport { calculateTextWidth };\n"],"names":["calculateTextWidth","text","theme","canvas","document","createElement","context","getContext","width","displayText","fontSize","typography","fonts","size","fontFamily","family","fontWeight","weight","medium","font","concat","fullTextWidth","measureText","availableWidth","MAX_WIDTH","PADDING_HORIZONTAL","finalWidth","Math","max","MIN_WIDTH","ELLIPSIS","ellipsisWidth","maxTextWidth","left","right","length","bestFit","mid","floor","testText","substring","testWidth","truncatedText"],"mappings":";;AAGMA,IAAAA,kBAAkB,GAAG,SAArBA,kBAAkBA,CAAIC,IAAY,EAAEC,KAAY,EAA6C;AACjG;AACA,EAAA,IAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC,CAAA;AAC/C,EAAA,IAAMC,OAAO,GAAGH,MAAM,CAACI,UAAU,CAAC,IAAI,CAAC,CAAA;EACvC,IAAI,CAACD,OAAO,EAAE,OAAO;AAAEE,IAAAA,KAAK,EAAE,EAAE;AAAEC,IAAAA,WAAW,EAAER,IAAAA;AAAK,GAAC,CAAC;;AAEtD;EACA,IAAMS,QAAQ,GAAGR,KAAK,CAACS,UAAU,CAACC,KAAK,CAACC,IAAI,CAAC,EAAE,CAAC,CAAA;EAChD,IAAMC,UAAU,GAAGZ,KAAK,CAACS,UAAU,CAACC,KAAK,CAACG,MAAM,CAACd,IAAI,CAAA;EACrD,IAAMe,UAAU,GAAGd,KAAK,CAACS,UAAU,CAACC,KAAK,CAACK,MAAM,CAACC,MAAM,CAAA;AAEvDZ,EAAAA,OAAO,CAACa,IAAI,GAAAC,EAAAA,CAAAA,MAAA,CAAMJ,UAAU,EAAA,GAAA,CAAA,CAAAI,MAAA,CAAIV,QAAQ,EAAA,KAAA,CAAA,CAAAU,MAAA,CAAMN,UAAU,CAAE,CAAA;;AAE1D;EACA,IAAMO,aAAa,GAAGf,OAAO,CAACgB,WAAW,CAACrB,IAAI,CAAC,CAACO,KAAK,CAAA;AACrD,EAAA,IAAMe,cAAc,GAAGC,SAAS,GAAGC,kBAAkB,CAAA;;AAErD;EACA,IAAIJ,aAAa,IAAIE,cAAc,EAAE;IACnC,IAAMG,WAAU,GAAGC,IAAI,CAACC,GAAG,CAACC,SAAS,EAAER,aAAa,GAAGI,kBAAkB,CAAC,CAAA;IAC1E,OAAO;AAAEjB,MAAAA,KAAK,EAAEkB,WAAU;AAAEjB,MAAAA,WAAW,EAAER,IAAAA;KAAM,CAAA;AACjD,GAAA;;AAEA;EACA,IAAM6B,QAAQ,GAAG,KAAK,CAAA;EACtB,IAAMC,aAAa,GAAGzB,OAAO,CAACgB,WAAW,CAACQ,QAAQ,CAAC,CAACtB,KAAK,CAAA;AACzD,EAAA,IAAMwB,YAAY,GAAGT,cAAc,GAAGQ,aAAa,CAAA;;AAEnD;EACA,IAAIE,IAAI,GAAG,CAAC,CAAA;AACZ,EAAA,IAAIC,KAAK,GAAGjC,IAAI,CAACkC,MAAM,CAAA;EACvB,IAAIC,OAAO,GAAG,EAAE,CAAA;EAEhB,OAAOH,IAAI,IAAIC,KAAK,EAAE;AACpB,IAAA,IAAMG,GAAG,GAAGV,IAAI,CAACW,KAAK,CAAC,CAACL,IAAI,GAAGC,KAAK,IAAI,CAAC,CAAC,CAAA;IAC1C,IAAMK,QAAQ,GAAGtC,IAAI,CAACuC,SAAS,CAAC,CAAC,EAAEH,GAAG,CAAC,CAAA;IACvC,IAAMI,SAAS,GAAGnC,OAAO,CAACgB,WAAW,CAACiB,QAAQ,CAAC,CAAC/B,KAAK,CAAA;IAErD,IAAIiC,SAAS,IAAIT,YAAY,EAAE;AAC7BI,MAAAA,OAAO,GAAGG,QAAQ,CAAA;MAClBN,IAAI,GAAGI,GAAG,GAAG,CAAC,CAAA;AAChB,KAAC,MAAM;MACLH,KAAK,GAAGG,GAAG,GAAG,CAAC,CAAA;AACjB,KAAA;AACF,GAAA;AAEA,EAAA,IAAMK,aAAa,GAAGN,OAAO,GAAGN,QAAQ,CAAA;EACxC,IAAMJ,UAAU,GAAGC,IAAI,CAACC,GAAG,CAACC,SAAS,EAAEL,SAAS,CAAC,CAAA;EAEjD,OAAO;AAAEhB,IAAAA,KAAK,EAAEkB,UAAU;AAAEjB,IAAAA,WAAW,EAAEiC,aAAAA;GAAe,CAAA;AAC1D;;;;"}