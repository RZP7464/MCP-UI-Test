{"version":3,"file":"useTimePickerState.js","sources":["../../../../../../src/components/TimePicker/useTimePickerState.ts"],"sourcesContent":["import React from 'react';\nimport { Time } from '@internationalized/date';\nimport type { UseTimePickerStateProps } from './types';\nimport { dateToTimeValue, timeValueToDate, getTimeComponents, createCompleteTime } from './utils';\nimport { useControllableState } from '~utils/useControllable';\n\n/**\n * Returns empty time value (midnight) when neither value nor defaultValue is provided\n */\nconst getEmptyTimeValue = (): Time => new Time(0, 0);\n\n/**\n * Return type for useTimePickerState hook\n */\ntype UseTimePickerStateReturn = {\n  timeValue: Date | null;\n  setTimeValue: (date: Date | null) => void;\n  isOpen: boolean;\n  setIsOpen: (isOpen: boolean) => void;\n  internalTimeValue: Time;\n  setInternalTimeValue: (timeValue: Time) => void;\n  selectedHour: number;\n  selectedMinute: number;\n  selectedPeriod: string;\n  onApply: () => void;\n  onCancel: () => void;\n  createCompleteTime: () => Date | null;\n};\n\n/**\n * Custom hook for TimePicker state management\n */\nexport const useTimePickerState = ({\n  value,\n  defaultValue,\n  onChange,\n  isOpen,\n  defaultIsOpen = false,\n  onOpenChange,\n  timeFormat = '12h',\n  showFooterActions = true,\n  onApply,\n}: UseTimePickerStateProps): UseTimePickerStateReturn => {\n  // Convert values for React Aria Time compatibility\n  const convertedValue = value !== undefined ? dateToTimeValue(value) : undefined;\n  const convertedDefaultValue =\n    defaultValue !== undefined ? dateToTimeValue(defaultValue) : undefined;\n\n  const [internalTimeValue, setInternalTimeValue] = useControllableState<Time>({\n    value: convertedValue ?? undefined,\n    defaultValue: convertedDefaultValue ?? undefined,\n    onChange: (timeValue) => {\n      const date = timeValueToDate(timeValue);\n      onChange?.({ value: date });\n    },\n  });\n\n  // For external API, expose as Date\n  const timeValue = timeValueToDate(internalTimeValue);\n  const setTimeValue = React.useCallback(\n    (date: Date | null) => {\n      setInternalTimeValue(() => dateToTimeValue(date) ?? getEmptyTimeValue());\n    },\n    [setInternalTimeValue],\n  );\n\n  // Old value backup for cancel functionality\n  const [oldTimeValue, setOldTimeValue] = React.useState<Time>(internalTimeValue);\n\n  // Manage controlled/uncontrolled open state\n  const [controllableIsOpen, setControllableIsOpen] = useControllableState({\n    value: isOpen,\n    defaultValue: defaultIsOpen,\n    onChange: (isOpen: boolean) => {\n      onOpenChange?.({ isOpen });\n      // Update old value every time timepicker is opened or closed\n      setOldTimeValue(internalTimeValue);\n    },\n  });\n\n  const handleApply = React.useCallback(() => {\n    if (showFooterActions) {\n      // Call onChange with current timeValue\n      onChange?.({ value: timeValue });\n      // Update oldTimeValue to current value\n      setOldTimeValue(internalTimeValue);\n      // Call onApply callback\n      onApply?.({ value: timeValue });\n    }\n    setControllableIsOpen(() => false);\n  }, [\n    timeValue,\n    internalTimeValue,\n    onChange,\n    setOldTimeValue,\n    onApply,\n    setControllableIsOpen,\n    showFooterActions,\n  ]);\n\n  const handleCancel = React.useCallback(() => {\n    // Restore internalTimeValue from oldTimeValue\n    setInternalTimeValue(() => oldTimeValue);\n    setControllableIsOpen(() => false);\n  }, [oldTimeValue, setInternalTimeValue, setControllableIsOpen]);\n\n  const { selectedHour, selectedMinute, selectedPeriod } = getTimeComponents(timeValue, timeFormat);\n\n  // Function to create complete time from current partial/full values\n  const createCompleteTimeCallback = React.useCallback(() => {\n    return createCompleteTime(selectedHour, selectedMinute, selectedPeriod, timeFormat);\n  }, [selectedHour, selectedMinute, selectedPeriod, timeFormat]);\n\n  return {\n    // Core state (Date API for external use)\n    timeValue,\n    setTimeValue,\n    isOpen: controllableIsOpen ?? false,\n    setIsOpen: (isOpen: boolean) => setControllableIsOpen(() => isOpen),\n\n    // TimeValue for React Aria compatibility\n    internalTimeValue,\n    setInternalTimeValue: (timeValue: Time) => setInternalTimeValue(() => timeValue),\n\n    // Individual time components for easy access\n    selectedHour,\n    selectedMinute,\n    selectedPeriod,\n\n    // Actions\n    onApply: handleApply,\n    onCancel: handleCancel,\n\n    // Time validation and creation\n    createCompleteTime: createCompleteTimeCallback,\n  } as const;\n};\n"],"names":["getEmptyTimeValue","Time","useTimePickerState","_ref","value","defaultValue","onChange","isOpen","_ref$defaultIsOpen","defaultIsOpen","onOpenChange","_ref$timeFormat","timeFormat","_ref$showFooterAction","showFooterActions","onApply","convertedValue","undefined","dateToTimeValue","convertedDefaultValue","_useControllableState","useControllableState","timeValue","date","timeValueToDate","_useControllableState2","_slicedToArray","internalTimeValue","setInternalTimeValue","setTimeValue","React","useCallback","_dateToTimeValue","_React$useState","useState","_React$useState2","oldTimeValue","setOldTimeValue","_useControllableState3","_useControllableState4","controllableIsOpen","setControllableIsOpen","handleApply","handleCancel","_getTimeComponents","getTimeComponents","selectedHour","selectedMinute","selectedPeriod","createCompleteTimeCallback","createCompleteTime","setIsOpen","onCancel"],"mappings":"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"}