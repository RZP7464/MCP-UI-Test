{"version":3,"file":"usePresetState.js","sources":["../../../../../../../src/components/DatePicker/QuickSelection/usePresetState.ts"],"sourcesContent":["import { useMemo } from 'react';\nimport type { DatesRangeValue } from '../types';\nimport { isSamePreset } from './utils';\nimport type { PresetState, UsePresetStateProps, UsePresetStateReturn } from './types';\n\nexport const usePresetState = ({\n  presets,\n  selectedPreset,\n  currentDate,\n}: UsePresetStateProps): UsePresetStateReturn => {\n  return useMemo(() => {\n    // No presets provided → return empty state\n    if (!presets) {\n      return {\n        presetStates: [],\n        selectedPresetIndex: null,\n        selectedPresetLabel: null,\n        isCustomSelected: false,\n        effectiveSelectionType: null, // Default when no presets\n      };\n    }\n\n    // STEP 1: Calculate each preset's value and type\n    // Example: \"Last 7 days\" → [2024-01-01, 2024-01-08], isCustomType: false\n    // Example: \"Custom\" → [null, null], isCustomType: true\n    const presetStates: PresetState[] = presets.map((preset) => {\n      let presetValue: DatesRangeValue | null = null;\n      let isCustomType = false;\n\n      presetValue = preset.value(currentDate); // Call function: \"Last 7 days\" → [startDate, endDate]\n      // Check if preset returns valid dates (defined) or null (custom)\n      isCustomType = !(presetValue?.[0] instanceof Date && presetValue?.[1] instanceof Date);\n\n      return {\n        preset, // Original preset object { label: \"Last 7 days\", value: fn }\n        value: presetValue, // Calculated dates [2024-01-01, 2024-01-08] or [null, null]\n        isSelected: false, // ⏳ Will calculate this next\n        isCustomType, // true = Custom preset, false = Defined preset\n      };\n    });\n\n    // STEP 2: Figure out which preset is currently selected\n    // Example: User selected [2024-01-01, 2024-01-08] → matches \"Last 7 days\" preset\n    let selectedPresetIndex: number | null = null;\n    let isCustomSelected = false;\n\n    if (!selectedPreset) {\n      // No dates selected → find and select \"Custom\" preset by default\n      selectedPresetIndex = presetStates.findIndex((state) => state.isCustomType);\n      isCustomSelected = selectedPresetIndex !== -1;\n    } else {\n      // User has selected dates → see if they match any defined preset\n      // Example: selectedPreset = [2024-01-01, 2024-01-08], check if matches \"Last 7 days\"\n      selectedPresetIndex = presetStates.findIndex(\n        (state) => !state.isCustomType && isSamePreset(selectedPreset, state.value),\n      );\n\n      if (selectedPresetIndex === -1) {\n        // No match found → user made custom selection → select \"Custom\" preset\n        selectedPresetIndex = presetStates.findIndex((state) => state.isCustomType);\n        isCustomSelected = true;\n      }\n    }\n\n    // STEP 3: Mark the selected preset as selected\n    if (selectedPresetIndex !== -1) {\n      presetStates[selectedPresetIndex].isSelected = true;\n    }\n\n    // STEP 4: Get the label for display\n    // Example: selectedPresetIndex = 0 → presetStates[0].preset.label = \"Last 7 days\"\n    const selectedPresetLabel =\n      selectedPresetIndex !== -1 ? presetStates[selectedPresetIndex].preset.label : null;\n\n    // STEP 5: Calculate effective selection type based on selected preset\n    // If preset returns same-day range (like \"Today\"), display as single date\n    let effectiveSelectionType: 'single' | 'range' = 'range'; // Default to range\n\n    if (selectedPresetIndex !== -1) {\n      const selectedPresetState = presetStates[selectedPresetIndex];\n\n      // Check if selected preset represents same day (like \"Today\" preset)\n      if (\n        selectedPresetState.value?.[0] &&\n        selectedPresetState.value?.[1] &&\n        selectedPresetState.value[0].toDateString() === selectedPresetState.value[1].toDateString()\n      ) {\n        effectiveSelectionType = 'single'; // Same day = display as single\n      } else {\n        effectiveSelectionType = 'range'; // Different days = display as range\n      }\n    }\n\n    // Return final calculated state - this gets shared with all components\n    return {\n      presetStates, // Array: [{ preset, value, isSelected, isCustomType }, ...]\n      selectedPresetIndex, // Number: 0, 1, 2... or null\n      selectedPresetLabel, // String: \"Last 7 days\" or \"Custom\" or null\n      isCustomSelected, // Boolean: true if custom dates selected\n      effectiveSelectionType, // 'single' | 'range' based on preset analysis\n    };\n  }, [presets, selectedPreset, currentDate]); // Recalculate when any of these change\n};\n"],"names":["usePresetState","_ref","presets","selectedPreset","currentDate","useMemo","presetStates","selectedPresetIndex","selectedPresetLabel","isCustomSelected","effectiveSelectionType","map","preset","_presetValue","_presetValue2","presetValue","isCustomType","value","Date","isSelected","findIndex","state","isSamePreset","label","_selectedPresetState$","_selectedPresetState$2","selectedPresetState","toDateString"],"mappings":"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"}