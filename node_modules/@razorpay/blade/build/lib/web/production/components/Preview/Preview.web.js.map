{"version":3,"file":"Preview.web.js","sources":["../../../../../../src/components/Preview/Preview.web.tsx"],"sourcesContent":["import React, { useState, useCallback, useEffect } from 'react';\nimport { TransformWrapper, TransformComponent, useControls } from 'react-zoom-pan-pinch';\nimport styled from 'styled-components';\nimport type {\n  PreviewProps,\n  PreviewHeaderProps,\n  PreviewFooterProps,\n  PreviewBodyProps,\n} from './types';\nimport { usePreviewContext, PreviewProvider } from './PreviewContext';\nimport BaseBox from '~components/Box/BaseBox';\nimport {\n  FullScreenEnterIcon,\n  ZoomInIcon,\n  ZoomOutIcon,\n  FullScreenExitIcon,\n  RefreshIcon,\n} from '~components/Icons';\nimport { Heading, Text } from '~components/Typography';\nimport { ButtonGroup } from '~components/ButtonGroup';\nimport { Button } from '~components/Button';\nimport { assignWithoutSideEffects } from '~utils/assignWithoutSideEffects';\nimport { MetaConstants } from '~utils/metaAttribute';\nimport { getComponentId } from '~utils/isValidAllowedChildren';\nimport { Divider } from '~components/Divider';\nimport { useControllableState } from '~utils/useControllable';\nimport { componentZIndices } from '~utils/componentZIndices';\n\nconst _PreviewHeader = ({\n  title,\n  _onFullScreen,\n  trailing,\n}: PreviewHeaderProps): React.ReactElement => {\n  const { isFullScreen } = usePreviewContext();\n\n  if (!title) {\n    return (\n      <BaseBox\n        position=\"absolute\"\n        top=\"spacing.0\"\n        right=\"spacing.2\"\n        zIndex={componentZIndices.previewPanel}\n        display=\"flex\"\n        alignItems=\"center\"\n        justifyContent=\"space-between\"\n        padding=\"spacing.4\"\n      >\n        <BaseBox backgroundColor=\"surface.background.gray.moderate\" borderRadius=\"medium\">\n          <Button\n            icon={isFullScreen ? FullScreenExitIcon : FullScreenEnterIcon}\n            variant=\"tertiary\"\n            onClick={_onFullScreen}\n            accessibilityLabel={isFullScreen ? 'Exit Full Screen' : 'Enter Full Screen'}\n          />\n        </BaseBox>\n        {trailing}\n      </BaseBox>\n    );\n  }\n  return (\n    <BaseBox\n      zIndex={componentZIndices.previewPanel}\n      position=\"absolute\"\n      top=\"spacing.0\"\n      left=\"spacing.0\"\n      backgroundColor=\"surface.background.gray.moderate\"\n      width=\"100%\"\n    >\n      <BaseBox\n        display=\"flex\"\n        alignItems=\"center\"\n        justifyContent=\"space-between\"\n        padding=\"spacing.5\"\n        height=\"100%\"\n        width=\"100%\"\n      >\n        <Heading size=\"medium\" weight=\"regular\" color=\"surface.text.gray.subtle\">\n          {title}\n        </Heading>\n        <BaseBox display=\"flex\" alignItems=\"center\" gap=\"spacing.3\">\n          <Button\n            icon={isFullScreen ? FullScreenExitIcon : FullScreenEnterIcon}\n            variant=\"tertiary\"\n            onClick={_onFullScreen}\n          />\n          {trailing}\n        </BaseBox>\n      </BaseBox>\n      <Divider orientation=\"horizontal\" />\n    </BaseBox>\n  );\n};\n\nconst PreviewHeader = assignWithoutSideEffects(_PreviewHeader, {\n  componentId: MetaConstants.PreviewHeader,\n});\n\nconst _PreviewBody = (PreviewBodyProps: PreviewBodyProps): React.ReactElement => {\n  const { children } = PreviewBodyProps;\n  return <BaseBox>{children}</BaseBox>;\n};\n\nconst PreviewBody = assignWithoutSideEffects(_PreviewBody, {\n  componentId: MetaConstants.PreviewBody,\n});\n\nconst _PreviewFooter = (PreviewFooterProps: PreviewFooterProps): React.ReactElement => {\n  const { showZoomPercentage, trailing } = PreviewFooterProps;\n  const { zoomIn, zoomOut, centerView } = useControls();\n  const { zoom, zoomScaleStep, defaultZoom } = usePreviewContext();\n  const handleZoomIn = useCallback(() => {\n    zoomIn(zoomScaleStep);\n  }, [zoomScaleStep, zoomIn]);\n\n  const handleZoomOut = useCallback(() => {\n    zoomOut(zoomScaleStep);\n  }, [zoomScaleStep, zoomOut]);\n\n  const handleReset = useCallback(() => {\n    // thanks to https://github.com/BetterTyped/react-zoom-pan-pinch/issues/286#issuecomment-1442888219\n    centerView(defaultZoom, 0);\n  }, [defaultZoom, centerView]);\n\n  return (\n    <BaseBox\n      display=\"flex\"\n      justifyContent=\"space-between\"\n      width=\"100%\"\n      backgroundColor=\"surface.background.gray.moderate\"\n      position=\"absolute\"\n      bottom=\"spacing.0\"\n      left=\"spacing.0\"\n      right=\"spacing.0\"\n      padding=\"spacing.5\"\n      zIndex={componentZIndices.previewPanel}\n      borderTopWidth=\"thin\"\n      borderTopColor=\"surface.border.gray.muted\"\n    >\n      <BaseBox\n        padding=\"spacing.2\"\n        backgroundColor=\"surface.background.gray.intense\"\n        borderRadius=\"medium\"\n        borderWidth=\"thin\"\n        borderColor=\"surface.border.gray.muted\"\n      >\n        {showZoomPercentage ? (\n          <BaseBox display=\"flex\" alignItems=\"center\" gap=\"spacing.2\">\n            <Button\n              icon={ZoomInIcon}\n              onClick={handleZoomIn}\n              variant=\"tertiary\"\n              accessibilityLabel=\"Zoom In\"\n              isDisabled={zoom >= 8}\n            />\n            <Text size=\"medium\"> {Math.round(zoom * 100)}%</Text>\n            <Button\n              icon={ZoomOutIcon}\n              onClick={handleZoomOut}\n              variant=\"tertiary\"\n              accessibilityLabel=\"Zoom Out\"\n              isDisabled={zoom <= 0.1}\n            />\n            <Button\n              icon={RefreshIcon}\n              onClick={() => handleReset()}\n              variant=\"tertiary\"\n              accessibilityLabel=\"Reset Zoom\"\n            />\n          </BaseBox>\n        ) : (\n          <BaseBox display=\"flex\" alignItems=\"center\" gap=\"spacing.2\">\n            <ButtonGroup variant=\"tertiary\">\n              <Button icon={ZoomInIcon} onClick={handleZoomIn} accessibilityLabel=\"Zoom In\" />\n              <Button icon={ZoomOutIcon} onClick={handleZoomOut} accessibilityLabel=\"Zoom Out\" />\n            </ButtonGroup>\n            <Button\n              icon={RefreshIcon}\n              onClick={() => handleReset()}\n              accessibilityLabel=\"Reset Zoom\"\n              variant=\"tertiary\"\n            />\n          </BaseBox>\n        )}\n      </BaseBox>\n      {trailing}\n    </BaseBox>\n  );\n};\n\nconst PreviewFooter = assignWithoutSideEffects(_PreviewFooter, {\n  componentId: MetaConstants.PreviewFooter,\n});\n\nconst dotSpacing = 16;\nconst dotOpacity = 0.1;\nconst dotSize = 1;\nconst ZoomContainer = styled.div<{ isDragEnabled: boolean; isDragging: boolean }>`\n  width: 100%;\n  height: 100%;\n  cursor: ${({ isDragEnabled, isDragging }) => {\n    if (!isDragEnabled) return 'default';\n    return isDragging ? 'grabbing' : 'grab';\n  }};\n  background-image: ${({ isDragEnabled }) =>\n    isDragEnabled\n      ? `radial-gradient(\n    circle,\n    rgba(0, 0, 0, ${dotOpacity}) ${dotSize}px,\n    transparent ${dotSize}px\n  )`\n      : 'none'};\n  background-size: ${dotSpacing}px ${dotSpacing}px;\n  .zoom-wrapper,\n  .zoom-content {\n    width: 100%;\n    height: 100%;\n    overflow: visible;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n  transition: cursor 0.1s ease;\n`;\n\nconst TransFormWrapperContainer = styled.div`\n  width: 100%;\n  height: 100%;\n  position: relative;\n  overflow: hidden;\n  background-color: ${({ theme }) => theme.colors.surface.background.gray.moderate};\n`;\nconst Preview = ({\n  children,\n  onFullScreen: onFullScreenProp,\n  onZoomChange,\n  zoomScaleStep = 0.1,\n  isDragAndZoomDisabled = false,\n  defaultZoom,\n  onDragChange,\n}: PreviewProps): React.ReactElement => {\n  const [controlledZoom, setControlledZoom] = useControllableState({\n    onChange: onZoomChange,\n    defaultValue: defaultZoom ?? 1,\n  });\n  const [isFullScreen, setIsFullScreen] = useState(false);\n  const [isDragging, setIsDragging] = useState(false);\n  const containerRef = React.useRef<HTMLDivElement>(null);\n\n  const handleTransformed = ({\n    state,\n  }: {\n    state: { scale: number; positionX: number; positionY: number };\n  }): void => {\n    const { scale, positionX, positionY } = state;\n    setControlledZoom(() => scale);\n    onDragChange?.({ x: positionX, y: positionY });\n  };\n\n  const handleFullScreenError = (err: unknown): void => {\n    if (err instanceof DOMException) {\n      console.error(`Fullscreen request failed: ${err.name} - ${err.message}`);\n    } else {\n      console.error('Unexpected error during fullscreen request:', err);\n    }\n  };\n\n  const handleFullScreen = useCallback(async () => {\n    if (!document.fullscreenElement) {\n      try {\n        await containerRef.current?.requestFullscreen();\n        setIsFullScreen(true);\n        onFullScreenProp?.();\n      } catch (err: unknown) {\n        handleFullScreenError(err);\n      }\n    } else {\n      try {\n        await document.exitFullscreen();\n        setIsFullScreen(false);\n        onFullScreenProp?.();\n      } catch (err: unknown) {\n        handleFullScreenError(err);\n      }\n    }\n  }, [onFullScreenProp]);\n\n  // this is added to handle the fullscreen change if user exits fullscreen using the escape key, or browser's exit fullscreen button\n  useEffect(() => {\n    const handleFullScreenChange = (): void => {\n      setIsFullScreen(!!document.fullscreenElement);\n    };\n\n    document.addEventListener('fullscreenchange', handleFullScreenChange);\n    return () => {\n      document.removeEventListener('fullscreenchange', handleFullScreenChange);\n    };\n  }, []);\n\n  // filter out preview header, preview body, preview footer separately using componentId\n  const previewHeader = React.Children.toArray(children)\n    .filter((child) => getComponentId(child as React.ReactElement) === MetaConstants.PreviewHeader)\n    .map((child) => {\n      if (React.isValidElement(child)) {\n        return React.cloneElement(child, {\n          // @ts-expect-error\n          _onFullScreen: handleFullScreen,\n        });\n      }\n      return child;\n    });\n\n  const previewBody = React.Children.toArray(children).filter(\n    (child) => getComponentId(child as React.ReactElement) === MetaConstants.PreviewBody,\n  );\n\n  const previewFooter = React.Children.toArray(children).filter(\n    (child) => getComponentId(child as React.ReactElement) === MetaConstants.PreviewFooter,\n  );\n\n  return (\n    <PreviewProvider\n      value={{\n        zoom: controlledZoom,\n        isFullScreen,\n        zoomScaleStep,\n        defaultZoom: defaultZoom ?? 1,\n      }}\n    >\n      <TransFormWrapperContainer ref={containerRef}>\n        <TransformWrapper\n          onTransformed={handleTransformed}\n          minScale={0.1}\n          maxScale={8}\n          disabled={isDragAndZoomDisabled}\n          initialScale={defaultZoom ?? controlledZoom}\n          doubleClick={{ disabled: false }}\n          onPanningStart={() => setIsDragging(true)}\n          onPanningStop={() => setIsDragging(false)}\n          panning={{ velocityDisabled: true }}\n          limitToBounds={false}\n          centerOnInit={true}\n        >\n          {() => (\n            <BaseBox width=\"100%\" height=\"100%\" position=\"relative\" overflow=\"visible\">\n              {previewFooter}\n              {previewHeader}\n              <ZoomContainer isDragEnabled={!isDragAndZoomDisabled} isDragging={isDragging}>\n                <TransformComponent wrapperClass=\"zoom-wrapper\" contentClass=\"zoom-content\">\n                  {previewBody}\n                </TransformComponent>\n              </ZoomContainer>\n            </BaseBox>\n          )}\n        </TransformWrapper>\n      </TransFormWrapperContainer>\n    </PreviewProvider>\n  );\n};\n\nexport { Preview, PreviewHeader, PreviewBody, PreviewFooter };\n"],"names":["_PreviewHeader","_ref","title","_onFullScreen","trailing","_usePreviewContext","usePreviewContext","isFullScreen","_jsxs","BaseBox","position","top","right","zIndex","componentZIndices","previewPanel","display","alignItems","justifyContent","padding","children","_jsx","backgroundColor","borderRadius","Button","icon","FullScreenExitIcon","FullScreenEnterIcon","variant","onClick","accessibilityLabel","left","width","height","Heading","size","weight","color","gap","Divider","orientation","PreviewHeader","assignWithoutSideEffects","componentId","MetaConstants","_PreviewBody","PreviewBodyProps","PreviewBody","_PreviewFooter","PreviewFooterProps","showZoomPercentage","_useControls","useControls","zoomIn","zoomOut","centerView","_usePreviewContext2","zoom","zoomScaleStep","defaultZoom","handleZoomIn","useCallback","handleZoomOut","handleReset","bottom","borderTopWidth","borderTopColor","borderWidth","borderColor","ZoomInIcon","isDisabled","Text","Math","round","ZoomOutIcon","RefreshIcon","ButtonGroup","PreviewFooter","dotSpacing","dotOpacity","dotSize","ZoomContainer","styled","div","withConfig","displayName","_ref2","isDragEnabled","isDragging","_ref3","concat","TransFormWrapperContainer","_ref4","theme","colors","surface","background","gray","moderate","Preview","_ref5","onFullScreenProp","onFullScreen","onZoomChange","_ref5$zoomScaleStep","_ref5$isDragAndZoomDi","isDragAndZoomDisabled","onDragChange","_useControllableState","useControllableState","onChange","defaultValue","_useControllableState2","_slicedToArray","controlledZoom","setControlledZoom","_useState","useState","_useState2","setIsFullScreen","_useState3","_useState4","setIsDragging","containerRef","React","useRef","handleTransformed","_ref6","state","scale","positionX","positionY","x","y","handleFullScreenError","err","DOMException","console","error","name","message","handleFullScreen","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_containerRef$current","_t","_t2","wrap","_context","prev","next","document","fullscreenElement","current","requestFullscreen","exitFullscreen","stop","useEffect","handleFullScreenChange","addEventListener","removeEventListener","previewHeader","Children","toArray","filter","child","getComponentId","map","isValidElement","cloneElement","previewBody","previewFooter","PreviewProvider","value","ref","TransformWrapper","onTransformed","minScale","maxScale","disabled","initialScale","doubleClick","onPanningStart","onPanningStop","panning","velocityDisabled","limitToBounds","centerOnInit","overflow","TransformComponent","wrapperClass","contentClass"],"mappings":"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"}