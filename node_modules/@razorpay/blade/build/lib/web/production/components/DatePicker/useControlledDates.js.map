{"version":3,"file":"useControlledDates.js","sources":["../../../../../../src/components/DatePicker/useControlledDates.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable default-case */\n/* eslint-disable @typescript-eslint/explicit-function-return-type */\nimport { useRef } from 'react';\nimport { useUncontrolled } from '@mantine/hooks';\nimport type { DatePickerType, DatePickerValue } from '@mantine/dates';\nimport { shiftTimezone } from './shiftTimezone';\nimport { throwBladeError } from '~utils/logger';\n\ninterface UseUncontrolledDates<Type extends DatePickerType = 'default'> {\n  type: Type;\n  value: DatePickerValue<Type> | undefined;\n  defaultValue: DatePickerValue<Type> | undefined;\n  onChange: ((value: DatePickerValue<Type>) => void) | undefined;\n  applyTimezone?: boolean;\n}\n\nconst getEmptyValue = <Type extends DatePickerType = 'default'>(type: Type) =>\n  type === 'range' ? [null, null] : type === 'multiple' ? [] : null;\n\nfunction useUncontrolledDates<Type extends DatePickerType = 'default'>({\n  type,\n  value,\n  defaultValue,\n  onChange,\n}: UseUncontrolledDates<Type>) {\n  const storedType = useRef<Type>(type);\n  const [_value, _setValue, controlled] = useUncontrolled<any>({\n    value: shiftTimezone('add', value),\n    defaultValue: shiftTimezone('add', defaultValue),\n    finalValue: getEmptyValue(type),\n    onChange: (newDate) => {\n      onChange?.(shiftTimezone('remove', newDate));\n    },\n  });\n\n  let _finalValue = _value;\n\n  if (storedType.current !== type) {\n    // Type has changed. Do some checks or resets\n\n    storedType.current = type;\n    if (value === undefined) {\n      // Reset uncontrolled value as types aren't compatible\n      _finalValue = defaultValue !== undefined ? defaultValue : getEmptyValue(type);\n      _setValue(_finalValue);\n    } else if (__DEV__) {\n      // Throw errors in dev mode in case type of value isn't correct\n      switch (type) {\n        case 'default':\n          if (value !== null && typeof value !== 'string') {\n            throwBladeError({\n              message: 'Value must be type of `null` or `string`',\n              moduleName: 'useControlledDates',\n            });\n          }\n          break;\n        case 'multiple':\n          if (!(value instanceof Array)) {\n            throwBladeError({\n              message: 'Value must be type of `string[]`',\n              moduleName: 'useControlledDates',\n            });\n          }\n          break;\n        case 'range':\n          if (!(value instanceof Array) || value.length !== 2) {\n            throwBladeError({\n              message: 'Value must be type of `[string, string]`',\n              moduleName: 'useControlledDates',\n            });\n          }\n          break;\n      }\n    }\n  }\n\n  return [_finalValue, _setValue, controlled];\n}\n\nexport { useUncontrolledDates };\n"],"names":["getEmptyValue","type","useUncontrolledDates","_ref","value","defaultValue","onChange","storedType","useRef","_useUncontrolled","useUncontrolled","shiftTimezone","finalValue","newDate","_useUncontrolled2","_slicedToArray","_value","_setValue","controlled","_finalValue","current","undefined","throwBladeError","message","moduleName","Array","length"],"mappings":"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"}