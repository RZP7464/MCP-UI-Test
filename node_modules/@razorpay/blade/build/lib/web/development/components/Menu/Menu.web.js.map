{"version":3,"file":"Menu.web.js","sources":["../../../../../../src/components/Menu/Menu.web.tsx"],"sourcesContent":["import {\n  FloatingFocusManager,\n  FloatingList,\n  FloatingNode,\n  FloatingPortal,\n  FloatingTree,\n  useFloatingParentNodeId,\n  useMergeRefs,\n} from '@floating-ui/react';\nimport * as React from 'react';\nimport { MenuContext, useFloatingMenuSetup, useMenu } from './useMenu';\nimport type { MenuProps } from './types';\n\nconst MenuTree = ({\n  children,\n  openInteraction = 'click',\n  onOpenChange,\n  isOpen: isOpenControlled,\n}: MenuProps): React.ReactElement => {\n  const [hasFocusInside, setHasFocusInside] = React.useState(false);\n\n  const elementsRef = React.useRef<(HTMLButtonElement | null)[]>([]);\n  const labelsRef = React.useRef<(string | null)[]>([]);\n  const parent = useMenu();\n\n  const {\n    getReferenceProps,\n    getFloatingProps,\n    getItemProps,\n    item,\n    refs,\n    floatingStyles,\n    isOpen,\n    nodeId,\n    isNested,\n    context,\n    isMounted,\n    floatingTransitionStyles,\n  } = useFloatingMenuSetup({\n    elementsRef,\n    openInteraction,\n    onOpenChange,\n    isOpen: isOpenControlled,\n  });\n\n  const referenceProps = {\n    ref: useMergeRefs([refs.setReference, item.ref]),\n    ...getReferenceProps(\n      parent.getItemProps({\n        onFocus() {\n          setHasFocusInside(false);\n          parent.setHasFocusInside(true);\n        },\n      }),\n    ),\n  };\n\n  const floatingProps = {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    ref: refs.setFloating as any,\n    style: floatingStyles,\n    _transitionStyle: floatingTransitionStyles,\n    ...getFloatingProps(),\n  };\n\n  const [menuTriggerChild, menuOverlayChild] = React.Children.toArray(children) as [\n    React.ReactElement,\n    React.ReactElement,\n  ];\n\n  const triggerWithReferenceProps = React.cloneElement(menuTriggerChild, {\n    ...menuTriggerChild.props,\n    ...referenceProps,\n    _hasFocusInside: hasFocusInside,\n    _isMenuTrigger: true,\n  });\n\n  const overlayWithFloatingProps = React.cloneElement(menuOverlayChild, {\n    ...menuOverlayChild.props,\n    ...floatingProps,\n  });\n\n  return (\n    <FloatingNode id={nodeId}>\n      <MenuContext.Provider\n        value={{\n          getItemProps,\n          setHasFocusInside,\n          isOpen,\n        }}\n      >\n        {triggerWithReferenceProps}\n        <FloatingList elementsRef={elementsRef} labelsRef={labelsRef}>\n          {isMounted && (\n            <FloatingPortal>\n              <FloatingFocusManager\n                context={context}\n                modal={false}\n                initialFocus={-1}\n                returnFocus={!isNested}\n              >\n                {overlayWithFloatingProps}\n              </FloatingFocusManager>\n            </FloatingPortal>\n          )}\n        </FloatingList>\n      </MenuContext.Provider>\n    </FloatingNode>\n  );\n};\n\nconst Menu = (props: MenuProps): React.ReactElement => {\n  const parentId = useFloatingParentNodeId();\n\n  if (parentId === null) {\n    return (\n      <FloatingTree>\n        <MenuTree {...props} />\n      </FloatingTree>\n    );\n  }\n\n  return <MenuTree {...props} />;\n};\n\nexport { Menu };\n"],"names":["MenuTree","_ref","children","_ref$openInteraction","openInteraction","onOpenChange","isOpenControlled","isOpen","_React$useState","React","useState","_React$useState2","_slicedToArray","hasFocusInside","setHasFocusInside","elementsRef","useRef","labelsRef","parent","useMenu","_useFloatingMenuSetup","useFloatingMenuSetup","getReferenceProps","getFloatingProps","getItemProps","item","refs","floatingStyles","nodeId","isNested","context","isMounted","floatingTransitionStyles","referenceProps","_objectSpread","ref","useMergeRefs","setReference","onFocus","floatingProps","setFloating","style","_transitionStyle","_ref2","Children","toArray","_ref3","menuTriggerChild","menuOverlayChild","triggerWithReferenceProps","cloneElement","props","_hasFocusInside","_isMenuTrigger","overlayWithFloatingProps","_jsx","FloatingNode","id","_jsxs","MenuContext","Provider","value","FloatingList","FloatingPortal","FloatingFocusManager","modal","initialFocus","returnFocus","Menu","parentId","useFloatingParentNodeId","FloatingTree"],"mappings":"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"}