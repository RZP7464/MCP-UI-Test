{"version":3,"file":"Collapsible.js","sources":["../../../../../../src/components/Collapsible/Collapsible.tsx"],"sourcesContent":["import type { ReactElement, ReactNode } from 'react';\nimport { Children, useCallback, useRef, useState, useMemo, forwardRef } from 'react';\n\nimport type { CollapsibleContextState } from './CollapsibleContext';\nimport { CollapsibleContext } from './CollapsibleContext';\nimport { MAX_WIDTH, MAX_WIDTH_NO_RESTRICTIONS } from './styles';\nimport { componentIds } from './componentIds';\nimport BaseBox from '~components/Box/BaseBox';\nimport type { DataAnalyticsAttribute, BladeElementRef, TestID } from '~utils/types';\nimport type { StyledPropsBlade } from '~components/Box/styledProps';\nimport { getStyledProps } from '~components/Box/styledProps';\nimport type { BoxProps } from '~components/Box';\nimport { makeSize } from '~utils';\nimport { size } from '~tokens/global';\nimport { metaAttribute, MetaConstants } from '~utils/metaAttribute';\nimport { useId } from '~utils/useId';\nimport { isValidAllowedChildren } from '~utils/isValidAllowedChildren';\nimport { throwBladeError } from '~utils/logger';\nimport { makeAnalyticsAttribute } from '~utils/makeAnalyticsAttribute';\nimport { assignWithoutSideEffects } from '~utils/assignWithoutSideEffects';\n\ntype CollapsibleProps = {\n  /**\n   * Composes `CollapsibleButton`, `CollapsibleLink`, `CollapsibleBody`\n   */\n  children: ReactNode;\n\n  /**\n   * Direction in which the content expands\n   *\n   * @default bottom\n   */\n  direction?: 'bottom' | 'top';\n\n  /**\n   * Expands the collapsible content by default (uncontrolled)\n   *\n   * @default false\n   */\n  defaultIsExpanded?: boolean;\n\n  /**\n   * Expands the collapsible content (controlled)\n   *\n   * @default undefined\n   */\n  isExpanded?: boolean;\n\n  /**\n   * Callback for change in collapsible's expanded state\n   *\n   * @default undefined\n   */\n  onExpandChange?: ({ isExpanded }: { isExpanded: boolean }) => void;\n\n  /**\n   * **Internal**: disables trigger validations. Used for AccordionButton and SideNavLink internally\n   */\n  _dangerouslyDisableValidations?: boolean;\n  /**\n   * **Internal**: used to override responsive width restrictions\n   */\n  _shouldApplyWidthRestrictions?: boolean;\n} & TestID &\n  DataAnalyticsAttribute &\n  StyledPropsBlade;\n\nconst MIN_WIDTH: BoxProps['minWidth'] = makeSize(size[200]);\n\nconst _Collapsible = (\n  {\n    children,\n    direction = 'bottom',\n    defaultIsExpanded = false,\n    isExpanded,\n    onExpandChange,\n    testID,\n    _shouldApplyWidthRestrictions = true,\n    _dangerouslyDisableValidations = false,\n    ...rest\n  }: CollapsibleProps,\n  ref: React.Ref<BladeElementRef>,\n): ReactElement => {\n  const [isBodyExpanded, setIsBodyExpanded] = useState(isExpanded ?? defaultIsExpanded);\n  const collapsibleBodyId = useId(MetaConstants.CollapsibleBody);\n\n  /**\n   * Maintain a ref to the initial value of `defaultExpanded || isExpanded` so changing it has no effect.\n   * This will help in determining the correct initial height of collapsing body content\n   */\n  const initialDefaultExpanded = useRef(Boolean(defaultIsExpanded || isExpanded));\n\n  const handleExpandChange = useCallback(\n    (nextIsExpanded: boolean) => {\n      if (typeof isExpanded !== 'undefined') {\n        // controlled\n        onExpandChange?.({ isExpanded: nextIsExpanded });\n      } else {\n        // uncontrolled\n        setIsBodyExpanded(nextIsExpanded);\n        onExpandChange?.({ isExpanded: nextIsExpanded });\n      }\n    },\n    [onExpandChange, isExpanded],\n  );\n\n  const contextValue = useMemo<CollapsibleContextState>(\n    () => ({\n      // controlled behavior if isExpanded is provided\n      isExpanded: isExpanded ?? isBodyExpanded,\n      onExpandChange: handleExpandChange,\n      defaultIsExpanded: initialDefaultExpanded.current,\n      direction,\n      collapsibleBodyId,\n    }),\n    [isBodyExpanded, direction, handleExpandChange, isExpanded, collapsibleBodyId],\n  );\n\n  if (__DEV__) {\n    Children.forEach(children, (child) => {\n      if (\n        !(\n          isValidAllowedChildren(child, componentIds.CollapsibleBody) ||\n          isValidAllowedChildren(child, componentIds.CollapsibleButton) ||\n          isValidAllowedChildren(child, componentIds.CollapsibleLink)\n        ) &&\n        !_dangerouslyDisableValidations\n      ) {\n        throwBladeError({\n          message: `only the following are supported as valid children: CollapsibleBody, CollapsibleButton, CollapsibleLink`,\n          moduleName: 'Collapsible',\n        });\n      }\n    });\n  }\n\n  return (\n    <CollapsibleContext.Provider value={contextValue}>\n      <BaseBox\n        ref={ref as never}\n        {...metaAttribute({ name: MetaConstants.Collapsible, testID })}\n        {...getStyledProps(rest)}\n        {...makeAnalyticsAttribute(rest)}\n      >\n        <BaseBox\n          display=\"flex\"\n          flexDirection={direction === 'bottom' ? 'column' : 'column-reverse'}\n          alignItems=\"flex-start\"\n          minWidth={_shouldApplyWidthRestrictions ? MIN_WIDTH : makeSize(size[0])}\n          maxWidth={_shouldApplyWidthRestrictions ? MAX_WIDTH : MAX_WIDTH_NO_RESTRICTIONS}\n        >\n          {children}\n        </BaseBox>\n      </BaseBox>\n    </CollapsibleContext.Provider>\n  );\n};\n\nconst Collapsible = assignWithoutSideEffects(forwardRef(_Collapsible), {\n  componentId: componentIds.Collapsible,\n});\n\nexport type { CollapsibleProps };\nexport { Collapsible };\n"],"names":["MIN_WIDTH","makeSize","size","_Collapsible","_ref","ref","children","_ref$direction","direction","_ref$defaultIsExpande","defaultIsExpanded","isExpanded","onExpandChange","testID","_ref$_shouldApplyWidt","_shouldApplyWidthRestrictions","_ref$_dangerouslyDisa","_dangerouslyDisableValidations","rest","_objectWithoutProperties","_excluded","_useState","useState","_useState2","_slicedToArray","isBodyExpanded","setIsBodyExpanded","collapsibleBodyId","useId","MetaConstants","CollapsibleBody","initialDefaultExpanded","useRef","Boolean","handleExpandChange","useCallback","nextIsExpanded","contextValue","useMemo","current","Children","forEach","child","isValidAllowedChildren","componentIds","CollapsibleButton","CollapsibleLink","throwBladeError","message","moduleName","_jsx","CollapsibleContext","Provider","value","BaseBox","_objectSpread","metaAttribute","name","Collapsible","getStyledProps","makeAnalyticsAttribute","display","flexDirection","alignItems","minWidth","maxWidth","MAX_WIDTH","MAX_WIDTH_NO_RESTRICTIONS","assignWithoutSideEffects","forwardRef","componentId"],"mappings":"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"}