{"version":3,"file":"BottomSheet.web.js","sources":["../../../../../../src/components/BottomSheet/BottomSheet.web.tsx"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable react/jsx-no-useless-fragment */\n/* eslint-disable consistent-return */\n/* eslint-disable @typescript-eslint/explicit-function-return-type */\nimport React from 'react';\nimport styled from 'styled-components';\nimport { rubberbandIfOutOfBounds, useDrag } from '@use-gesture/react';\nimport usePresence from 'use-presence';\nimport { clearAllBodyScrollLocks, enableBodyScroll } from 'body-scroll-lock-upgrade';\nimport { BottomSheetHeader } from './BottomSheetHeader';\nimport { BottomSheetFooter } from './BottomSheetFooter';\nimport { BottomSheetBody } from './BottomSheetBody';\nimport type { SnapPoints } from './utils';\nimport { computeMaxContent, computeSnapPointBounds } from './utils';\nimport { BottomSheetBackdrop } from './BottomSheetBackdrop';\nimport type { BottomSheetContextProps } from './BottomSheetContext';\nimport { BottomSheetContext, useBottomSheetAndDropdownGlue } from './BottomSheetContext';\nimport { ComponentIds } from './componentIds';\nimport type { BottomSheetProps } from './types';\nimport { BottomSheetGrabHandle } from './BottomSheetGrabHandle';\nimport { useBottomSheetStack } from './BottomSheetStack';\nimport BaseBox from '~components/Box/BaseBox';\nimport { metaAttribute, MetaConstants } from '~utils/metaAttribute';\nimport { useScrollLock } from '~utils/useScrollLock';\nimport { useWindowSize } from '~utils/useWindowSize';\nimport { useIsomorphicLayoutEffect } from '~utils/useIsomorphicLayoutEffect';\nimport { useTheme } from '~components/BladeProvider';\nimport { useId } from '~utils/useId';\nimport { assignWithoutSideEffects } from '~utils/assignWithoutSideEffects';\nimport { makeSize } from '~utils/makeSize';\nimport { makeAccessible } from '~utils/makeAccessible';\nimport { size } from '~tokens/global';\nimport { makeMotionTime } from '~utils/makeMotionTime';\nimport { componentZIndices } from '~utils/componentZIndices';\nimport { makeAnalyticsAttribute } from '~utils/makeAnalyticsAttribute';\n\nexport const BOTTOM_SHEET_EASING = 'cubic-bezier(.15,0,.24,.97)';\nconst AUTOCOMPLETE_DEFAULT_SNAPPOINT = 0.85;\n\nconst BottomSheetSurface = styled.div<{\n  windowHeight: number;\n  isDragging: boolean;\n}>(({ theme, windowHeight, isDragging }) => {\n  return {\n    background: theme.colors.popup.background.subtle,\n    borderTopLeftRadius: makeSize(size[16]),\n    borderTopRightRadius: makeSize(size[16]),\n    borderColor: theme.colors.popup.border.subtle,\n    // this is reverse top elevation of highRaised elevation token\n    boxShadow: '0px -24px 48px -12px hsla(217, 56%, 17%, 0.18)',\n    opacity: 0,\n    pointerEvents: 'none',\n    transitionDuration: isDragging\n      ? undefined\n      : `${makeMotionTime(theme.motion.duration.moderate)}`,\n    transitionTimingFunction: BOTTOM_SHEET_EASING,\n    willChange: 'transform, opacity, height',\n    transitionProperty: 'transform, opacity, height',\n    position: 'fixed',\n    left: 0,\n    right: 0,\n    bottom: 0,\n    top: windowHeight,\n    backgroundColor: theme.colors.popup.background.subtle,\n    justifyContent: 'center',\n    alignItems: 'center',\n    touchAction: 'none',\n    overflow: 'hidden',\n  };\n});\n\nconst _BottomSheet = ({\n  isOpen,\n  onDismiss,\n  children,\n  initialFocusRef,\n  snapPoints = [0.35, 0.5, 0.85],\n  isDismissible = true,\n  zIndex = componentZIndices.bottomSheet,\n  ...dataAnalyticsProps\n}: BottomSheetProps): React.ReactElement => {\n  const { theme } = useTheme();\n  const dimensions = useWindowSize();\n  const [contentHeight, setContentHeight] = React.useState(0);\n  const [headerHeight, setHeaderHeight] = React.useState(0);\n  const [footerHeight, setFooterHeight] = React.useState(0);\n  const [grabHandleHeight, setGrabHandleHeight] = React.useState(0);\n  const [hasBodyPadding, setHasBodyPadding] = React.useState(true);\n  const [isHeaderEmpty, setIsHeaderEmpty] = React.useState(false);\n\n  const bottomSheetAndDropdownGlue = useBottomSheetAndDropdownGlue();\n  const [positionY, _setPositionY] = React.useState(0);\n  const _isOpen = isOpen ?? bottomSheetAndDropdownGlue?.isOpen;\n  const [isDragging, setIsDragging] = React.useState(false);\n\n  const preventScrollingRef = React.useRef(true);\n  const scrollRef = React.useRef<HTMLDivElement>(null);\n  const grabHandleRef = React.useRef<HTMLDivElement>(null);\n  const defaultInitialFocusRef = React.useRef<any>(null);\n  const originalFocusElement = React.useRef<HTMLElement | null>(null);\n  const initialSnapPoint = React.useRef<number>(snapPoints[1]);\n  const totalHeight = React.useMemo(() => {\n    return grabHandleHeight + headerHeight + footerHeight + contentHeight;\n  }, [contentHeight, footerHeight, grabHandleHeight, headerHeight]);\n\n  const id = useId();\n  const {\n    stack,\n    addBottomSheetToStack,\n    removeBottomSheetFromStack,\n    getTopOfTheStack,\n    getCurrentStackIndexById,\n  } = useBottomSheetStack();\n  const currentStackIndex = getCurrentStackIndexById(id);\n  const isOnTopOfStack = getTopOfTheStack() === id;\n  const bottomSheetZIndex = zIndex - currentStackIndex;\n\n  const setPositionY = React.useCallback(\n    (value: number, limit = true) => {\n      // In AutoComplete, we want BottomSheet to be docked to top snappoint so we remove the limits\n      const shouldLimitPositionY = limit && !bottomSheetAndDropdownGlue?.hasAutoCompleteInHeader;\n\n      const maxValue = computeMaxContent({\n        contentHeight,\n        footerHeight,\n        // If headerHeight is zero no need to add height of grabHandleHeight.\n        headerHeight: headerHeight > 0 ? headerHeight + grabHandleHeight : 0,\n        maxHeight: value,\n      });\n      _setPositionY(shouldLimitPositionY ? maxValue : value);\n    },\n    [\n      bottomSheetAndDropdownGlue?.hasAutoCompleteInHeader,\n      contentHeight,\n      footerHeight,\n      grabHandleHeight,\n      headerHeight,\n    ],\n  );\n\n  // locks the body scroll to prevent accidental scrolling of content when we drag the sheet\n  // We are ready when we calculated the height of the content\n  const isReady = contentHeight > 0;\n  // only lock the body when we atleast have 1 bottomsheet open\n  const shouldLock = isReady && stack.length > 0;\n  const scrollLockRef = useScrollLock({\n    enabled: shouldLock,\n    targetRef: scrollRef,\n    reserveScrollBarGap: true,\n  });\n\n  // clear all body locks to avoid memory leaks & accidental body locking\n  React.useEffect(() => {\n    const hasNoBottomSheets = stack.length < 1;\n    if (hasNoBottomSheets) {\n      clearAllBodyScrollLocks();\n    }\n  }, [stack]);\n\n  // take the grabHandle's height into headerHeight too\n  useIsomorphicLayoutEffect(() => {\n    if (!grabHandleRef.current) return;\n    const marginBottom = window.getComputedStyle(grabHandleRef.current).marginBottom;\n    setGrabHandleHeight(\n      grabHandleRef.current.getBoundingClientRect().height + parseFloat(marginBottom),\n    );\n  }, [grabHandleRef.current, _isOpen]);\n\n  // if bottomSheet height is >35% & <50% then set initial snapPoint to 35%\n  useIsomorphicLayoutEffect(() => {\n    if (bottomSheetAndDropdownGlue?.hasAutoCompleteInHeader) {\n      initialSnapPoint.current = AUTOCOMPLETE_DEFAULT_SNAPPOINT;\n    } else {\n      const middleSnapPoint = snapPoints[1] * dimensions.height;\n      const lowerSnapPoint = snapPoints[0] * dimensions.height;\n      if (totalHeight > lowerSnapPoint && totalHeight < middleSnapPoint) {\n        initialSnapPoint.current = snapPoints[0];\n      }\n    }\n  }, [dimensions.height, snapPoints, totalHeight]);\n\n  const returnFocus = React.useCallback(() => {\n    if (!originalFocusElement.current) return;\n    originalFocusElement.current.focus();\n    // After returning focus we will clear the original focus\n    // Because if sheet can be opened up via multiple triggers\n    // We want to ensure the focus returns back to the most recent triggerer\n    originalFocusElement.current = null;\n  }, [originalFocusElement]);\n\n  const focusOnInitialRef = React.useCallback(() => {\n    if (!initialFocusRef) {\n      // focus on close button\n      defaultInitialFocusRef.current?.focus();\n    } else {\n      // focus on the initialRef passed by the user\n      initialFocusRef.current?.focus();\n    }\n  }, [initialFocusRef]);\n\n  // focus on the initial ref when the sheet is opened\n  React.useLayoutEffect(() => {\n    if (_isOpen) {\n      focusOnInitialRef();\n    }\n  }, [_isOpen, focusOnInitialRef]);\n\n  const handleOnOpen = React.useCallback(() => {\n    setPositionY(dimensions.height * initialSnapPoint.current);\n    scrollLockRef.current.activate();\n    // initialize the original focused element\n    // On first render it will be the activeElement, eg: the button trigger or select input\n    // On Subsequent open operations it won't further update the original focus\n    originalFocusElement.current =\n      originalFocusElement.current ?? (document.activeElement as HTMLElement);\n  }, [dimensions.height, scrollLockRef, setPositionY]);\n\n  const handleOnClose = React.useCallback(() => {\n    setPositionY(0);\n  }, [setPositionY]);\n\n  const close = React.useCallback(() => {\n    if (isDismissible) {\n      onDismiss?.();\n      bottomSheetAndDropdownGlue?.onBottomSheetDismiss?.();\n    }\n    returnFocus();\n  }, [isDismissible, onDismiss, bottomSheetAndDropdownGlue, returnFocus]);\n\n  // sync controlled state to our actions\n  React.useEffect(() => {\n    if (_isOpen) {\n      // open on the next frame, otherwise the animations will not run on first render\n      window.setTimeout(() => {\n        handleOnOpen();\n      });\n    } else {\n      handleOnClose();\n    }\n  }, [_isOpen, handleOnClose, handleOnOpen]);\n\n  // let the Dropdown component know that it's rendering a bottomsheet\n  React.useEffect(() => {\n    if (!bottomSheetAndDropdownGlue) return;\n    bottomSheetAndDropdownGlue.setDropdownHasBottomSheet(true);\n  }, [bottomSheetAndDropdownGlue]);\n\n  const bind = useDrag(\n    ({\n      active,\n      last,\n      cancel,\n      tap,\n      movement: [_movementX, movementY],\n      velocity: [_velocityX, velocityY],\n      lastOffset: [_, lastOffsetY],\n      down,\n      dragging,\n      event,\n      args: [{ isContentDragging = false } = {}] = [],\n    }) => {\n      // Check if the touch started on a scrollable element (e.g., SpinWheel in TimePicker)\n      // This prevents BottomSheet drag gestures from interfering with internal scrolling\n      const touchTarget = event?.target as Element | undefined;\n      const isScrollableContent = touchTarget?.closest('[data-allow-scroll]');\n\n      if (isScrollableContent) {\n        return;\n      }\n      setIsDragging(Boolean(dragging));\n      // lastOffsetY is the previous position user stopped dragging the sheet\n      // movementY is the drag amount from the bottom of the screen, so as you drag up the movementY goes into negatives\n      // and rawY is the calculated offset from the last position of the bottomsheet to current drag amount.\n      const rawY = lastOffsetY - movementY;\n\n      const lowerSnapPoint = dimensions.height * snapPoints[0];\n      const upperSnapPoint = dimensions.height * snapPoints[snapPoints.length - 1];\n\n      // predictedY is used to create velocity driven swipe\n      // the faster you swipe the more distance you cover\n      // this enables users to reach upper & lower snappoint with a single swipe\n      const predictedDistance = movementY * (velocityY / 2);\n      const predictedY = Math.max(\n        lowerSnapPoint,\n        Math.min(upperSnapPoint, rawY - predictedDistance * 2),\n      );\n\n      let newY = rawY;\n\n      if (down) {\n        // Ensure that users aren't able to drag the sheet\n        // more than the upperSnapPoint or maximum height of the sheet\n        // this is basically a clamp() function but creates a nice rubberband effect\n        const dampening = 0.55;\n        if (totalHeight < upperSnapPoint) {\n          newY = rubberbandIfOutOfBounds(rawY, 0, totalHeight, dampening);\n        } else {\n          newY = rubberbandIfOutOfBounds(rawY, 0, upperSnapPoint, dampening);\n        }\n      } else {\n        newY = predictedY;\n      }\n\n      const isPosAtUpperSnapPoint = newY >= upperSnapPoint;\n\n      if (isContentDragging) {\n        if (isPosAtUpperSnapPoint) {\n          newY = upperSnapPoint;\n        }\n\n        // keep the newY at upper snap point\n        // until the scrollable content is not at top\n        // and previously saved Y position is greater than or equal to upper snap point\n        // Note: how using newY won't work here since we need the previous value of the newY\n        // since we always keep updating the newY,\n        // this is cruicial in making the scroll feel natural\n        const isContentScrolledAtTop = scrollRef.current && scrollRef.current.scrollTop <= 0;\n        if (lastOffsetY === upperSnapPoint && !isContentScrolledAtTop) {\n          newY = upperSnapPoint;\n        }\n        preventScrollingRef.current = newY < upperSnapPoint;\n      }\n\n      if (last) {\n        // calculate the nearest snapPoint\n        const [nearest, lower] = computeSnapPointBounds(\n          newY,\n          snapPoints.map((point) => dimensions.height * point) as SnapPoints,\n        );\n\n        // This ensure that the lower snapPoint will always have atleast some buffer\n        // When the bottomsheet total height is less than the lower snapPoint\n        // Video walkthrough: https://www.loom.com/share/a9a8db7688d64194b13df8b3e25859ae\n        const lowerPointBuffer = 60;\n        const lowerestSnap = Math.min(lower, totalHeight) - lowerPointBuffer;\n\n        const shouldClose = rawY < lowerestSnap;\n        if (shouldClose) {\n          if (isDismissible) {\n            // Allow closing if dismissible\n            setIsDragging(false);\n            cancel();\n            close();\n            return;\n          } else {\n            // If not dismissible, snap back to first snap point instead of closing\n            setIsDragging(false);\n            cancel();\n            const firstSnapPoint = dimensions.height * snapPoints[0];\n            setPositionY(firstSnapPoint, true);\n            return;\n          }\n        }\n\n        // if we stop dragging assign snap to the nearest point\n        if (!active && !tap) {\n          newY = nearest;\n        }\n      }\n\n      setPositionY(newY, !down);\n    },\n    {\n      from: [0, positionY],\n      filterTaps: true,\n      enabled: isOnTopOfStack && _isOpen,\n    },\n  );\n\n  // Here we are preventing the scrolling of the content, until the preventScrollingRef value is true\n  useIsomorphicLayoutEffect(() => {\n    const scrollElement = scrollRef.current;\n    if (!scrollElement) return;\n\n    const preventScrolling = (e: Event) => {\n      if (preventScrollingRef?.current) {\n        // Allow scrolling for components that explicitly need scroll functionality\n        const target = e.target as Element;\n        const isAllowedComponent = target.closest('[data-allow-scroll]');\n\n        if (!isAllowedComponent) {\n          e.preventDefault();\n        }\n      }\n    };\n\n    // https://www.bram.us/2016/05/02/prevent-overscroll-bounce-in-ios-mobilesafari-pure-css/\n    const preventSafariOverscroll = (e: Event) => {\n      if (scrollElement.scrollTop < 0) {\n        // TODO: figure this out, it doesn't seem to work >iOS12\n        // requestAnimationFrame(() => {\n        //   elem.style.overflow = 'hidden';\n        //   elem.scrollTop = 0;\n        //   elem.style.removeProperty('overflow');\n        // });\n        e.preventDefault();\n      }\n    };\n\n    scrollElement.addEventListener('scroll', preventScrolling);\n    scrollElement.addEventListener('touchmove', preventScrolling);\n    scrollElement.addEventListener('touchstart', preventSafariOverscroll);\n    return () => {\n      scrollElement.removeEventListener('scroll', preventScrolling);\n      scrollElement.removeEventListener('touchmove', preventScrolling);\n      scrollElement.removeEventListener('touchstart', preventSafariOverscroll);\n    };\n    // Only run this hook when we know all the layout calculations are done,\n    // Otherwise the scrollRef.current will be null.\n    // isReady prop will ensure that we are done measuring the content height\n  }, [isReady]);\n\n  // usePresence hook waits for the animation to finish before unmounting the component\n  // It's similar to motion/react's usePresence hook\n  // https://www.framer.com/docs/animate-presence/#usepresence\n  const { isMounted, isVisible } = usePresence(Boolean(_isOpen), {\n    transitionDuration: theme.motion.duration.moderate,\n  });\n\n  const isHeaderFloating = !hasBodyPadding && isHeaderEmpty;\n  const contextValue: BottomSheetContextProps = React.useMemo(\n    () => ({\n      isInBottomSheet: true,\n      isOpen: Boolean(isVisible),\n      close,\n      positionY,\n      headerHeight,\n      contentHeight,\n      footerHeight,\n      setContentHeight,\n      setFooterHeight,\n      setHeaderHeight,\n      setHasBodyPadding,\n      setIsHeaderEmpty,\n      scrollRef,\n      bind,\n      defaultInitialFocusRef,\n      isHeaderFloating,\n      isDismissible,\n    }),\n    [\n      isVisible,\n      close,\n      positionY,\n      headerHeight,\n      contentHeight,\n      footerHeight,\n      setContentHeight,\n      setFooterHeight,\n      setHeaderHeight,\n      setHasBodyPadding,\n      setIsHeaderEmpty,\n      scrollRef,\n      bind,\n      defaultInitialFocusRef,\n      isHeaderFloating,\n      isDismissible,\n    ],\n  );\n\n  React.useEffect(() => {\n    if (isMounted) {\n      addBottomSheetToStack(id);\n    } else {\n      removeBottomSheetFromStack(id);\n    }\n  }, [addBottomSheetToStack, id, isMounted, removeBottomSheetFromStack]);\n\n  // Remove the bottomsheet from the stack, if it's unmounted forcefully\n  React.useEffect(() => {\n    return () => {\n      if (id === undefined) return;\n      removeBottomSheetFromStack(id);\n    };\n  }, [id, removeBottomSheetFromStack]);\n\n  // Disable body scroll lock when the component is unmounted forcefully\n  React.useEffect(() => {\n    const lockTarget = scrollRef.current;\n    return () => {\n      if (lockTarget) {\n        enableBodyScroll(lockTarget);\n      }\n    };\n    // when BottomSheet is mounted with isOpen={false}, then BottomSheetBody does not set scrollRef\n    // so, we added scrollRef to dependencies array to ensure that we update lockTarget when scrollRef is updated\n    // which will avoid passing null to enableBodyScroll\n  }, [scrollRef]);\n\n  // We will need to reset these values otherwise the next time the bottomsheet opens\n  // this will be populated and the animations won't run\n  // why?: because how the usePresence hook works, we actually just unmount the\n  // html contents not the whole <BottomSheet /> react component\n  React.useEffect(() => {\n    if (!isMounted) {\n      setHeaderHeight(0);\n      setFooterHeight(0);\n      setContentHeight(0);\n      setGrabHandleHeight(0);\n      _setPositionY(0);\n    }\n  }, [isMounted, scrollLockRef]);\n\n  // We don't want to destroy the react tree when we are rendering inside Dropdown\n  // Because if we bail out early then ActionList won't render,\n  // and Dropdown manages it's state based on the rendered JSX of ActionList\n  // If we don't render ActionList Dropdown state will reset each time we open/close BottomSheet\n  const isInsideDropdown = Boolean(bottomSheetAndDropdownGlue);\n  if (!isMounted && !isInsideDropdown) {\n    return <></>;\n  }\n\n  return (\n    <BottomSheetContext.Provider value={contextValue}>\n      <BottomSheetBackdrop zIndex={bottomSheetZIndex} />\n      <BottomSheetSurface\n        {...metaAttribute({\n          name: MetaConstants.BottomSheet,\n          testID: 'bottomsheet-surface',\n        })}\n        {...makeAccessible({ modal: true, role: 'dialog' })}\n        windowHeight={dimensions.height}\n        isDragging={isDragging}\n        style={{\n          opacity: isVisible ? 1 : 0,\n          pointerEvents: isVisible ? 'all' : 'none',\n          height: positionY,\n          bottom: 0,\n          top: 'auto',\n          zIndex: bottomSheetZIndex,\n        }}\n        {...makeAnalyticsAttribute(dataAnalyticsProps)}\n      >\n        <BaseBox height=\"100%\" display=\"flex\" flexDirection=\"column\">\n          <BottomSheetGrabHandle\n            ref={grabHandleRef}\n            isHeaderFloating={isHeaderFloating}\n            {...metaAttribute({ name: ComponentIds.BottomSheetGrabHandle })}\n            {...bind()}\n          />\n          {children}\n        </BaseBox>\n      </BottomSheetSurface>\n    </BottomSheetContext.Provider>\n  );\n};\n\nconst BottomSheet = assignWithoutSideEffects(_BottomSheet, {\n  componentId: ComponentIds.BottomSheet,\n});\n\nexport { BottomSheet, BottomSheetBody, BottomSheetHeader, BottomSheetFooter };\nexport type { BottomSheetProps };\n"],"names":["BOTTOM_SHEET_EASING","AUTOCOMPLETE_DEFAULT_SNAPPOINT","BottomSheetSurface","styled","div","withConfig","displayName","componentId","_ref","theme","windowHeight","isDragging","background","colors","popup","subtle","borderTopLeftRadius","makeSize","size","borderTopRightRadius","borderColor","border","boxShadow","opacity","pointerEvents","transitionDuration","undefined","concat","makeMotionTime","motion","duration","moderate","transitionTimingFunction","willChange","transitionProperty","position","left","right","bottom","top","backgroundColor","justifyContent","alignItems","touchAction","overflow","_BottomSheet","_ref2","isOpen","onDismiss","children","initialFocusRef","_ref2$snapPoints","snapPoints","_ref2$isDismissible","isDismissible","_ref2$zIndex","zIndex","componentZIndices","bottomSheet","dataAnalyticsProps","_objectWithoutProperties","_excluded","_useTheme","useTheme","dimensions","useWindowSize","_React$useState","React","useState","_React$useState2","_slicedToArray","contentHeight","setContentHeight","_React$useState3","_React$useState4","headerHeight","setHeaderHeight","_React$useState5","_React$useState6","footerHeight","setFooterHeight","_React$useState7","_React$useState8","grabHandleHeight","setGrabHandleHeight","_React$useState9","_React$useState0","hasBodyPadding","setHasBodyPadding","_React$useState1","_React$useState10","isHeaderEmpty","setIsHeaderEmpty","bottomSheetAndDropdownGlue","useBottomSheetAndDropdownGlue","_React$useState11","_React$useState12","positionY","_setPositionY","_isOpen","_React$useState13","_React$useState14","setIsDragging","preventScrollingRef","useRef","scrollRef","grabHandleRef","defaultInitialFocusRef","originalFocusElement","initialSnapPoint","totalHeight","useMemo","id","useId","_useBottomSheetStack","useBottomSheetStack","stack","addBottomSheetToStack","removeBottomSheetFromStack","getTopOfTheStack","getCurrentStackIndexById","currentStackIndex","isOnTopOfStack","bottomSheetZIndex","setPositionY","useCallback","value","limit","arguments","length","shouldLimitPositionY","hasAutoCompleteInHeader","maxValue","computeMaxContent","maxHeight","isReady","shouldLock","scrollLockRef","useScrollLock","enabled","targetRef","reserveScrollBarGap","useEffect","hasNoBottomSheets","clearAllBodyScrollLocks","useIsomorphicLayoutEffect","current","marginBottom","window","getComputedStyle","getBoundingClientRect","height","parseFloat","middleSnapPoint","lowerSnapPoint","returnFocus","focus","focusOnInitialRef","_defaultInitialFocusR","_initialFocusRef$curr","useLayoutEffect","handleOnOpen","_originalFocusElement","activate","document","activeElement","handleOnClose","close","_bottomSheetAndDropdo","onBottomSheetDismiss","call","setTimeout","setDropdownHasBottomSheet","bind","useDrag","_ref3","active","last","cancel","tap","_ref3$movement","movement","_movementX","movementY","_ref3$velocity","velocity","_velocityX","velocityY","_ref3$lastOffset","lastOffset","_","lastOffsetY","down","dragging","event","_ref3$args","args","_ref3$args2","_ref3$args3","_ref3$args3$","_ref3$args3$2","_ref3$args3$2$isConte","isContentDragging","touchTarget","target","isScrollableContent","closest","Boolean","rawY","upperSnapPoint","predictedDistance","predictedY","Math","max","min","newY","dampening","rubberbandIfOutOfBounds","isPosAtUpperSnapPoint","isContentScrolledAtTop","scrollTop","_computeSnapPointBoun","computeSnapPointBounds","map","point","_computeSnapPointBoun2","nearest","lower","lowerPointBuffer","lowerestSnap","shouldClose","firstSnapPoint","from","filterTaps","scrollElement","preventScrolling","e","isAllowedComponent","preventDefault","preventSafariOverscroll","addEventListener","removeEventListener","_usePresence","usePresence","isMounted","isVisible","isHeaderFloating","contextValue","isInBottomSheet","lockTarget","enableBodyScroll","isInsideDropdown","_jsx","_Fragment","_jsxs","BottomSheetContext","Provider","BottomSheetBackdrop","_objectSpread","metaAttribute","name","MetaConstants","BottomSheet","testID","makeAccessible","modal","role","style","makeAnalyticsAttribute","BaseBox","display","flexDirection","BottomSheetGrabHandle","ref","ComponentIds","assignWithoutSideEffects"],"mappings":"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"}