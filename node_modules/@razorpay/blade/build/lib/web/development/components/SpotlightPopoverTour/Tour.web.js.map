{"version":3,"file":"Tour.web.js","sources":["../../../../../../src/components/SpotlightPopoverTour/Tour.web.tsx"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-use-before-define */\n/* eslint-disable consistent-return */\n/* eslint-disable @typescript-eslint/explicit-function-return-type */\nimport React, { useState, useCallback, useMemo } from 'react';\nimport { FloatingPortal } from '@floating-ui/react';\nimport { TourContext } from './TourContext';\nimport { TourPopover } from './TourPopover';\nimport {\n  smoothScroll,\n  useDelayedState,\n  useIntersectionObserver,\n  useIsTransitioningBetweenSteps,\n  useLockBodyScroll,\n} from './utils';\nimport type { SpotlightPopoverTourMaskRect, SpotlightPopoverTourProps } from './types';\nimport { SpotlightPopoverTourMask } from './TourMask';\nimport { transitionDelay } from './tourTokens';\nimport { useTheme } from '~components/BladeProvider';\nimport { useIsomorphicLayoutEffect } from '~utils/useIsomorphicLayoutEffect';\n\nconst SpotlightPopoverTour = ({\n  steps,\n  activeStep,\n  isOpen,\n  onFinish,\n  onOpenChange,\n  onStepChange,\n  children,\n}: SpotlightPopoverTourProps): React.ReactElement => {\n  const { theme } = useTheme();\n  const [refIdMap, setRefIdMap] = useState(new Map<string, React.RefObject<HTMLElement>>());\n  const [size, setSize] = useState<SpotlightPopoverTourMaskRect>({\n    x: 0,\n    y: 0,\n    height: 0,\n    width: 0,\n  });\n\n  // delayed state is used to let the transition finish before reacting to the state changes\n  const [delayedActiveStep] = useDelayedState(activeStep, transitionDelay);\n  const [delayedSize, setDelayedSize] = useDelayedState(size, transitionDelay);\n  // keep track of when we are transitioning between steps\n  const isTransitioning = useIsTransitioningBetweenSteps(activeStep, transitionDelay);\n  const [isScrolling, setIsScrolling] = useState(false);\n\n  const currentStepRef = refIdMap.get(steps[activeStep]?.name);\n  const intersection = useIntersectionObserver(currentStepRef!, {\n    threshold: 0.5,\n  });\n\n  // main step logic\n  const totalSteps = steps.length;\n  const currentStepData = useMemo(() => {\n    return steps[activeStep];\n  }, [activeStep, steps]);\n\n  const goToStep = useCallback(\n    (step: number) => {\n      if (step < 0 || step >= steps.length) return;\n      onStepChange?.(step);\n    },\n    [onStepChange, steps.length],\n  );\n\n  const goToNext = useCallback(() => {\n    let nextState = activeStep + 1;\n    if (nextState >= steps.length) {\n      nextState = steps.length - 1;\n    }\n    onStepChange?.(nextState);\n  }, [activeStep, onStepChange, steps.length]);\n\n  const goToPrevious = useCallback(() => {\n    let nextState = activeStep - 1;\n    if (nextState < 0) {\n      nextState = 0;\n    }\n    onStepChange?.(nextState);\n  }, [activeStep, onStepChange]);\n\n  const stopTour = useCallback(() => {\n    onFinish?.();\n  }, [onFinish]);\n\n  const attachStep = useCallback((id: string, ref: React.RefObject<HTMLElement>) => {\n    if (!ref) return;\n    setRefIdMap((prev) => {\n      return new Map(prev).set(id, ref);\n    });\n  }, []);\n\n  const removeStep = useCallback((id: string) => {\n    setRefIdMap((prev) => {\n      const newMap = new Map(prev);\n      newMap.delete(id);\n      return newMap;\n    });\n  }, []);\n\n  const updateMaskSize = useCallback(\n    (shouldSkipDelay = false) => {\n      const ref = refIdMap.get(steps[activeStep]?.name);\n      if (!ref?.current) return;\n\n      const rect = ref.current.getBoundingClientRect();\n      setSize({\n        x: rect.x,\n        y: rect.y,\n        width: rect.width,\n        height: rect.height,\n      });\n      if (shouldSkipDelay) {\n        setDelayedSize({\n          x: rect.x,\n          y: rect.y,\n          width: rect.width,\n          height: rect.height,\n        });\n      }\n    },\n    [activeStep, refIdMap, setDelayedSize, steps],\n  );\n\n  const scrollToStep = useCallback(() => {\n    const ref = refIdMap.get(steps[delayedActiveStep]?.name);\n    if (!ref?.current) return;\n\n    // If the element is already in view, don't scroll\n    if (intersection?.isIntersecting) return;\n\n    setIsScrolling(true);\n    smoothScroll(ref.current, {\n      behavior: 'smooth',\n      block: 'center',\n      inline: 'center',\n    })\n      .then(() => {\n        // wait for the scroll to finish before updating the mask size\n        // We also don't want to delay the size update since its already delayed by the scroll\n        updateMaskSize(true);\n      })\n      .finally(() => {\n        setIsScrolling(false);\n      });\n  }, [delayedActiveStep, refIdMap, steps, updateMaskSize, intersection?.isIntersecting]);\n\n  // Update the size of the mask when the active step changes\n  useIsomorphicLayoutEffect(() => {\n    updateMaskSize();\n  }, [activeStep, updateMaskSize]);\n\n  // Scroll into view when the active step changes\n  useIsomorphicLayoutEffect(() => {\n    // We need to wait for the transition to finish before scrolling\n    // Otherwise the browser sometimes interrupts the scroll\n    const scrollDelay = 100;\n    setTimeout(() => {\n      if (!isOpen) return;\n      if (isTransitioning) return;\n      scrollToStep();\n    }, scrollDelay);\n  }, [isOpen, scrollToStep, isTransitioning]);\n\n  // reset the mask size when the tour is closed\n  useIsomorphicLayoutEffect(() => {\n    if (isOpen) {\n      // on initial mount, we don't want to delay the size update\n      updateMaskSize(true);\n      onOpenChange?.({ isOpen });\n    }\n    if (!isOpen) {\n      setSize({\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0,\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isOpen]);\n\n  useLockBodyScroll(isOpen);\n\n  const contextValue = useMemo(() => {\n    return { attachStep, removeStep };\n  }, [attachStep, removeStep]);\n\n  return (\n    <TourContext.Provider value={contextValue}>\n      <FloatingPortal>\n        {isOpen ? (\n          <SpotlightPopoverTourMask\n            isTransitioning={isTransitioning || isScrolling}\n            padding={theme.spacing[4]}\n            size={delayedSize}\n          />\n        ) : null}\n      </FloatingPortal>\n\n      {steps.map((step) => {\n        const isStepActive = currentStepData.name === step.name;\n        const attachTo = isStepActive ? currentStepRef : undefined;\n        // 1. only show popover if the tour is opened\n        // 2. only show the popover if the step is active\n        // 3. do not show the popover if we are transitioning between steps\n        //    this ensures popover suddenly doesn't jump to the next step,\n        //    instead it waits for the transition to finish\n        const isPopoverVisible = isOpen && isStepActive && !isTransitioning;\n\n        return (\n          <TourPopover\n            key={step.name}\n            isTransitioning={delayedActiveStep !== activeStep}\n            placement={step.placement}\n            isOpen={isPopoverVisible}\n            onOpenChange={onOpenChange}\n            title={step.title}\n            titleLeading={step.titleLeading}\n            content={step?.content?.({\n              activeStep: delayedActiveStep,\n              goToPrevious,\n              goToNext,\n              goToStep,\n              totalSteps,\n              stopTour,\n            })}\n            footer={step?.footer?.({\n              activeStep: delayedActiveStep,\n              goToPrevious,\n              goToNext,\n              goToStep,\n              totalSteps,\n              stopTour,\n            })}\n            attachTo={attachTo}\n          />\n        );\n      })}\n\n      {children}\n    </TourContext.Provider>\n  );\n};\n\nexport { SpotlightPopoverTour };\n"],"names":["SpotlightPopoverTour","_ref","_steps$activeStep","steps","activeStep","isOpen","onFinish","onOpenChange","onStepChange","children","_useTheme","useTheme","theme","_useState","useState","Map","_useState2","_slicedToArray","refIdMap","setRefIdMap","_useState3","x","y","height","width","_useState4","size","setSize","_useDelayedState","useDelayedState","transitionDelay","_useDelayedState2","delayedActiveStep","_useDelayedState3","_useDelayedState4","delayedSize","setDelayedSize","isTransitioning","useIsTransitioningBetweenSteps","_useState5","_useState6","isScrolling","setIsScrolling","currentStepRef","get","name","intersection","useIntersectionObserver","threshold","totalSteps","length","currentStepData","useMemo","goToStep","useCallback","step","goToNext","nextState","goToPrevious","stopTour","attachStep","id","ref","prev","set","removeStep","newMap","updateMaskSize","_steps$activeStep2","shouldSkipDelay","arguments","undefined","current","rect","getBoundingClientRect","scrollToStep","_steps$delayedActiveS","isIntersecting","smoothScroll","behavior","block","inline","then","useIsomorphicLayoutEffect","scrollDelay","setTimeout","useLockBodyScroll","contextValue","_jsxs","TourContext","Provider","value","_jsx","FloatingPortal","SpotlightPopoverTourMask","padding","spacing","map","_step$content","_step$footer","isStepActive","attachTo","isPopoverVisible","TourPopover","placement","title","titleLeading","content","call","footer"],"mappings":"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"}