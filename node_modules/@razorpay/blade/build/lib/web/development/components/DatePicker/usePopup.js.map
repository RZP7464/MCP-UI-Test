{"version":3,"file":"usePopup.js","sources":["../../../../../../src/components/DatePicker/usePopup.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/explicit-function-return-type */\nimport type { UseFloatingOptions } from '@floating-ui/react';\nimport {\n  autoUpdate,\n  flip,\n  offset,\n  shift,\n  useClick,\n  useDismiss,\n  useFloating,\n  useInteractions,\n  useRole,\n  useTransitionStyles,\n} from '@floating-ui/react';\nimport { size, spacing } from '~tokens/global';\nimport { useTheme } from '~utils';\nimport { getFloatingPlacementParts } from '~utils/getFloatingPlacementParts';\n\ntype UsePopupProps = {\n  enabled?: boolean;\n  open?: boolean;\n  placement: UseFloatingOptions['placement'];\n  onOpenChange?: UseFloatingOptions['onOpenChange'];\n  referenceRef: React.RefObject<HTMLButtonElement> | React.RefObject<HTMLElement>;\n  crossAxisOffset?: number;\n};\n\nconst usePopup = ({\n  enabled = true,\n  placement,\n  open,\n  onOpenChange,\n  referenceRef,\n  crossAxisOffset = 0,\n}: UsePopupProps) => {\n  const GAP = spacing[4];\n  const { theme } = useTheme();\n  const [side] = getFloatingPlacementParts(placement!);\n  const isOppositeAxis = side === 'right' || side === 'bottom';\n\n  const { refs, floatingStyles, context, placement: computedPlacement } = useFloating({\n    open,\n    onOpenChange: (isOpen, event, reason) => {\n      onOpenChange?.(isOpen, event, reason);\n      if (reason === 'escape-key') {\n        referenceRef.current?.focus();\n      }\n    },\n    placement,\n    strategy: 'fixed',\n    elements: {\n      reference: referenceRef.current,\n    },\n    middleware: [\n      shift({ crossAxis: false, padding: GAP }),\n      flip({ padding: GAP, fallbackAxisSideDirection: 'end' }),\n      // Combined offset: default GAP + custom crossAxis adjustment\n      // crossAxisOffset allows fine-tuning calendar position (e.g., align with input text vs input border)\n      offset({ mainAxis: GAP, crossAxis: crossAxisOffset }),\n    ],\n    whileElementsMounted: (reference, floating, update) =>\n      autoUpdate(reference, floating, update, {\n        elementResize: false,\n      }),\n  });\n\n  // we need to animate from the offset of the computed placement\n  // because placement can change dynamically based on available space\n  const [computedSide] = getFloatingPlacementParts(computedPlacement);\n  const computedIsHorizontal = computedSide === 'left' || computedSide === 'right';\n  const animationOffset = isOppositeAxis ? -size[4] : size[4];\n  const { isMounted, styles: animationStyles } = useTransitionStyles(context, {\n    duration: theme.motion.duration.quick,\n    initial: {\n      opacity: 0,\n      transform: `translate${computedIsHorizontal ? 'X' : 'Y'}(${animationOffset}px)`,\n    },\n  });\n\n  // remove click handler if popover is controlled\n  const click = useClick(context);\n  const dismiss = useDismiss(context, { enabled });\n  const role = useRole(context);\n  const { getReferenceProps, getFloatingProps } = useInteractions([click, dismiss, role]);\n\n  return {\n    refs,\n    context,\n    isMounted,\n    floatingStyles,\n    animationStyles,\n    getReferenceProps,\n    getFloatingProps,\n  } as const;\n};\n\nexport { usePopup };\n"],"names":["usePopup","_ref","_ref$enabled","enabled","placement","open","onOpenChange","referenceRef","_ref$crossAxisOffset","crossAxisOffset","GAP","spacing","_useTheme","useTheme","theme","_getFloatingPlacement","getFloatingPlacementParts","_getFloatingPlacement2","_slicedToArray","side","isOppositeAxis","_useFloating","useFloating","isOpen","event","reason","_referenceRef$current","current","focus","strategy","elements","reference","middleware","shift","crossAxis","padding","flip","fallbackAxisSideDirection","offset","mainAxis","whileElementsMounted","floating","update","autoUpdate","elementResize","refs","floatingStyles","context","computedPlacement","_getFloatingPlacement3","_getFloatingPlacement4","computedSide","computedIsHorizontal","animationOffset","size","_useTransitionStyles","useTransitionStyles","duration","motion","quick","initial","opacity","transform","concat","isMounted","animationStyles","styles","click","useClick","dismiss","useDismiss","role","useRole","_useInteractions","useInteractions","getReferenceProps","getFloatingProps"],"mappings":"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"}