{"version":3,"file":"CircularProgressBar.web.js","sources":["../../../../../../src/components/ProgressBar/CircularProgressBar.web.tsx"],"sourcesContent":["import type { FlattenSimpleInterpolation } from 'styled-components';\nimport styled, { css, keyframes } from 'styled-components';\nimport React from 'react';\nimport type { CircularProgressBarFilledProps } from './types';\nimport {\n  pulseAnimation,\n  circularProgressSizeTokens,\n  getCircularProgressSVGTokens,\n} from './progressBarTokens';\nimport { CircularProgressLabel } from './CircularProgressLabel';\nimport getIn from '~utils/lodashButBetter/get';\nimport BaseBox from '~components/Box/BaseBox';\nimport { castWebType } from '~utils';\nimport { makeMotionTime } from '~utils/makeMotionTime';\nimport type { TextProps } from '~components/Typography';\nimport { getTextProps } from '~components/Typography';\nimport { Svg, Circle } from '~components/Icons/_Svg';\nimport getBaseTextStyles from '~components/Typography/BaseText/getBaseTextStyles';\n\nconst pulseKeyframes = keyframes`\n  0% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.65;\n  }\n  100% {\n    opacity: 1;\n  }\n`;\n\nconst getPulseAnimationStyles = ({\n  duration,\n  easing,\n  progressPercent,\n  isMeter,\n}: {\n  duration: string;\n  easing: string;\n  progressPercent: number;\n  isMeter: boolean;\n}): FlattenSimpleInterpolation => {\n  if (isMeter || progressPercent === 100) {\n    return css`\n      height: 100%;\n      width: 100%;\n      transition: stroke-dashoffset ${duration} ${easing};\n    `;\n  }\n\n  return css`\n    height: 100%;\n    width: 100%;\n    opacity: ${pulseAnimation.opacityInitial};\n    background-color: ${pulseAnimation.backgroundColor};\n    transition: stroke-dashoffset ${duration} ${easing};\n    animation: ${pulseKeyframes} ${duration} ${easing} infinite;\n  `;\n};\n\nconst StyledSVGText = styled.text<Pick<TextProps<{ variant: 'body' }>, 'size' | 'weight'>>(\n  ({ theme, size, weight }) => {\n    return {\n      ...getBaseTextStyles({\n        theme,\n        ...getTextProps({ variant: 'body', size, weight }),\n      }),\n      fill: theme.colors.surface.text.gray.normal,\n    };\n  },\n);\n\nconst DeterminatePulseAnimation = styled.circle<\n  Pick<\n    CircularProgressBarFilledProps,\n    'pulseMotionDuration' | 'pulseMotionDelay' | 'motionEasing' | 'progressPercent' | 'isMeter'\n  >\n>(({ theme, pulseMotionDuration, motionEasing, progressPercent, isMeter }) => {\n  const duration = castWebType(makeMotionTime(getIn(theme.motion, pulseMotionDuration)));\n  const easing = castWebType(getIn(theme.motion, motionEasing));\n\n  return getPulseAnimationStyles({\n    duration,\n    easing,\n    progressPercent,\n    isMeter,\n  });\n});\n\nconst CircularProgressBarFilled = ({\n  progressPercent,\n  fillColor,\n  backgroundColor,\n  size = 'small',\n  label,\n  showPercentage = true,\n  isMeter,\n}: CircularProgressBarFilledProps): React.ReactElement => {\n  const {\n    sqSize,\n    strokeWidth,\n    radius,\n    viewBox,\n    dashArray,\n    dashOffset,\n  } = getCircularProgressSVGTokens({ size, progressPercent });\n\n  return (\n    <BaseBox\n      width=\"fit-content\"\n      textAlign=\"center\"\n      display=\"flex\"\n      flexDirection=\"column\"\n      alignItems=\"center\"\n    >\n      <Svg width={String(sqSize)} height={String(sqSize)} viewBox={viewBox}>\n        <Circle\n          fill=\"none\"\n          stroke={backgroundColor}\n          cx={String(sqSize / 2)}\n          cy={String(sqSize / 2)}\n          r={String(radius)}\n          strokeWidth={`${strokeWidth}px`}\n        />\n\n        <DeterminatePulseAnimation\n          progressPercent={progressPercent}\n          isMeter={isMeter}\n          fill=\"none\"\n          stroke={fillColor}\n          cx={sqSize / 2}\n          cy={sqSize / 2}\n          r={radius}\n          strokeWidth={`${strokeWidth}px`}\n          // Start progress marker at 12 O'Clock\n          transform={`rotate(-90 ${sqSize / 2} ${sqSize / 2})`}\n          strokeDasharray={dashArray}\n          strokeDashoffset={dashOffset}\n          pulseMotionDuration=\"duration.2xgentle\"\n          pulseMotionDelay=\"delay.long\"\n          motionEasing=\"easing.emphasized\"\n        />\n        {showPercentage && size !== 'small' && (\n          <StyledSVGText\n            size={circularProgressSizeTokens[size].percentTextSize}\n            weight=\"semibold\"\n            x=\"50%\"\n            y=\"50%\"\n            textAnchor=\"middle\"\n            dy=\".4em\"\n          >\n            {progressPercent}%\n          </StyledSVGText>\n        )}\n      </Svg>\n\n      <CircularProgressLabel\n        progressPercent={progressPercent}\n        size={size}\n        label={label}\n        showPercentage={showPercentage}\n      />\n    </BaseBox>\n  );\n};\n\nexport { CircularProgressBarFilled };\n"],"names":["pulseKeyframes","keyframes","getPulseAnimationStyles","_ref","duration","easing","progressPercent","isMeter","css","pulseAnimation","opacityInitial","backgroundColor","StyledSVGText","styled","text","withConfig","displayName","componentId","_ref2","theme","size","weight","_objectSpread","getBaseTextStyles","getTextProps","variant","fill","colors","surface","gray","normal","DeterminatePulseAnimation","circle","_ref3","pulseMotionDuration","motionEasing","castWebType","makeMotionTime","getIn","motion","CircularProgressBarFilled","_ref4","fillColor","_ref4$size","label","_ref4$showPercentage","showPercentage","_getCircularProgressS","getCircularProgressSVGTokens","sqSize","strokeWidth","radius","viewBox","dashArray","dashOffset","_jsxs","BaseBox","width","textAlign","display","flexDirection","alignItems","children","Svg","String","height","_jsx","Circle","stroke","cx","cy","r","concat","transform","strokeDasharray","strokeDashoffset","pulseMotionDelay","circularProgressSizeTokens","percentTextSize","x","y","textAnchor","dy","CircularProgressLabel"],"mappings":"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"}