{"version":3,"file":"BaseInputTagSlot.native.js","sources":["../../../../../../src/components/Input/BaseInput/BaseInputTagSlot.native.tsx"],"sourcesContent":["import React from 'react';\nimport { ScrollView, TouchableWithoutFeedback } from 'react-native';\nimport type { BaseInputTagSlotProps } from './types';\nimport { baseInputHeight } from './baseInputTokens';\nimport BaseBox from '~components/Box/BaseBox';\nimport { makeSize } from '~utils';\nimport { size as sizeToken } from '~tokens/global';\nimport { Text } from '~components/Typography';\nimport type { StringChildrenType } from '~utils/types';\n\nconst ScrollableTagSlotContainer = ({\n  maxTagRows,\n  children,\n  handleOnInputClick,\n}: Pick<BaseInputTagSlotProps, 'maxTagRows' | 'showAllTags' | 'handleOnInputClick'> & {\n  children: (React.ReactNode | null)[];\n}): React.ReactElement => {\n  const scrollViewRef = React.useRef<ScrollView>(null);\n  const [isScrolling, setIsScrolling] = React.useState(false);\n  return (\n    <ScrollView\n      ref={scrollViewRef}\n      contentContainerStyle={{\n        flexWrap: maxTagRows === 'single' ? 'nowrap' : 'wrap',\n        position: 'relative',\n        flexDirection: 'row',\n        flexGrow: 1,\n        alignItems: 'center',\n      }}\n      onScrollBeginDrag={() => {\n        setIsScrolling(true);\n      }}\n      onScrollEndDrag={() => {\n        setIsScrolling(false);\n      }}\n      horizontal={maxTagRows === 'single'}\n      showsHorizontalScrollIndicator={maxTagRows === 'single'}\n      onContentSizeChange={() => {\n        scrollViewRef.current?.scrollToEnd({ animated: true });\n      }}\n    >\n      {/* This creates a clickable layer behind tags so if user clicks empty area between of tags, it handles opening of Dropdown */}\n      <TouchableWithoutFeedback\n        onPress={() => {\n          if (!isScrolling) {\n            handleOnInputClick();\n          }\n        }}\n      >\n        <BaseBox position=\"absolute\" height=\"100%\" width=\"100%\" />\n      </TouchableWithoutFeedback>\n      {children}\n    </ScrollView>\n  );\n};\n\nconst ClickableText = ({\n  children,\n  handleOnInputClick,\n  isDisabled,\n}: {\n  children: StringChildrenType;\n  handleOnInputClick: BaseInputTagSlotProps['handleOnInputClick'];\n  isDisabled: BaseInputTagSlotProps['isDisabled'];\n}): React.ReactElement => {\n  return (\n    <TouchableWithoutFeedback\n      onPress={() => {\n        handleOnInputClick();\n      }}\n    >\n      <BaseBox alignSelf=\"center\" marginRight=\"spacing.4\">\n        <Text\n          size=\"small\"\n          variant=\"body\"\n          weight=\"regular\"\n          color={isDisabled ? 'surface.text.gray.disabled' : 'surface.text.gray.subtle'}\n        >\n          {children}\n        </Text>\n      </BaseBox>\n    </TouchableWithoutFeedback>\n  );\n};\n\nconst PLUS_X_MORE_TEXT_WIDTH = 60;\n\nconst BaseInputTagSlot = ({\n  tags,\n  maxTagRows,\n  showAllTags,\n  handleOnInputClick,\n  renderAs,\n  children,\n  isDropdownTrigger,\n  labelPrefix,\n  isDisabled,\n  numberOfLines,\n  isTextArea,\n  size,\n}: BaseInputTagSlotProps): React.ReactElement | null => {\n  const hasTags = tags && tags.length > 0;\n  const initialVisibleTags = maxTagRows === 'multiple' ? 6 : 1;\n  const [visibleTags, setVisibleTags] = React.useState(labelPrefix ? 0 : initialVisibleTags);\n  const invisibleTagsCount = tags || (tags && labelPrefix) ? tags.length - visibleTags : 0;\n\n  if (!isDropdownTrigger) {\n    return children;\n  }\n\n  return (\n    <BaseBox\n      justifyContent=\"flex-start\"\n      paddingY=\"spacing.1\"\n      paddingX=\"spacing.4\"\n      minHeight={makeSize(baseInputHeight[size])}\n      height={\n        isTextArea && isDropdownTrigger\n          ? makeSize(baseInputHeight[size] * (numberOfLines ?? 1))\n          : undefined\n      }\n      display=\"flex\"\n      flexDirection=\"row\"\n      position=\"relative\"\n      flex=\"1\"\n      onLayout={(e) => {\n        if (!hasTags) return;\n\n        if (labelPrefix) {\n          setVisibleTags(0);\n          return;\n        }\n\n        if (maxTagRows === 'multiple') {\n          // The calculation is for single-line versions.\n          // In multiline, we have default 6 tags in RN\n          return;\n        }\n\n        const containerWidth = e.nativeEvent?.layout?.width;\n        if (!containerWidth) {\n          return;\n        }\n\n        const availableTagsSpace = containerWidth - PLUS_X_MORE_TEXT_WIDTH;\n        const visibleTagsCount = Math.floor(availableTagsSpace / 140);\n        setVisibleTags(visibleTagsCount);\n      }}\n    >\n      <ScrollableTagSlotContainer\n        maxTagRows={maxTagRows}\n        showAllTags={showAllTags}\n        handleOnInputClick={handleOnInputClick}\n      >\n        {hasTags ? (\n          <>\n            {showAllTags || maxTagRows === 'multiple' ? tags : tags.slice(0, visibleTags)}\n            {invisibleTagsCount > 0 && !showAllTags && !labelPrefix && maxTagRows !== 'multiple' ? (\n              <ClickableText isDisabled={isDisabled} handleOnInputClick={handleOnInputClick}>\n                + {invisibleTagsCount} More\n              </ClickableText>\n            ) : null}\n            {!showAllTags && invisibleTagsCount > 0 && labelPrefix ? (\n              <ClickableText isDisabled={isDisabled} handleOnInputClick={handleOnInputClick}>\n                {labelPrefix} ({invisibleTagsCount} Selected)\n              </ClickableText>\n            ) : null}\n          </>\n        ) : null}\n        <BaseBox width={hasTags && renderAs === 'button' ? makeSize(sizeToken['1']) : '100%'}>\n          {children}\n        </BaseBox>\n      </ScrollableTagSlotContainer>\n      <TouchableWithoutFeedback\n        onPress={() => {\n          handleOnInputClick();\n        }}\n      >\n        <BaseBox flex=\"1\" />\n      </TouchableWithoutFeedback>\n    </BaseBox>\n  );\n};\n\nexport { BaseInputTagSlot };\n"],"names":["ScrollableTagSlotContainer","_ref","maxTagRows","children","handleOnInputClick","scrollViewRef","React","useRef","_React$useState","useState","_React$useState2","_slicedToArray","isScrolling","setIsScrolling","_jsxs","ScrollView","ref","contentContainerStyle","flexWrap","position","flexDirection","flexGrow","alignItems","onScrollBeginDrag","onScrollEndDrag","horizontal","showsHorizontalScrollIndicator","onContentSizeChange","_scrollViewRef$curren","current","scrollToEnd","animated","_jsx","TouchableWithoutFeedback","onPress","BaseBox","height","width","ClickableText","_ref2","isDisabled","alignSelf","marginRight","Text","size","variant","weight","color","PLUS_X_MORE_TEXT_WIDTH","BaseInputTagSlot","_ref3","tags","showAllTags","renderAs","isDropdownTrigger","labelPrefix","numberOfLines","isTextArea","hasTags","length","initialVisibleTags","_React$useState3","_React$useState4","visibleTags","setVisibleTags","invisibleTagsCount","justifyContent","paddingY","paddingX","minHeight","makeSize","baseInputHeight","undefined","display","flex","onLayout","e","_e$nativeEvent","_e$nativeEvent$layout","containerWidth","nativeEvent","layout","availableTagsSpace","visibleTagsCount","Math","floor","_Fragment","slice","sizeToken"],"mappings":"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"}