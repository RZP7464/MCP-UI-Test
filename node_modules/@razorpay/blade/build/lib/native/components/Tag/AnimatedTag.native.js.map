{"version":3,"file":"AnimatedTag.native.js","sources":["../../../../../src/components/Tag/AnimatedTag.native.tsx"],"sourcesContent":["import React from 'react';\nimport type { EasingFn } from 'react-native-reanimated';\nimport Animated, {\n  Easing,\n  useSharedValue,\n  withTiming,\n  useAnimatedStyle,\n  runOnJS,\n  Keyframe,\n} from 'react-native-reanimated';\nimport type { ReanimatedKeyframe } from 'react-native-reanimated/lib/typescript/reanimated2/layoutReanimation/animationBuilder/Keyframe';\nimport { Tag } from './Tag';\nimport {\n  TAG_MAX_WIDTH_END,\n  TAG_MAX_WIDTH_START,\n  TAG_OPACITY_END,\n  TAG_OPACITY_START,\n} from './tagAnimationConfig';\nimport type { AnimatedTagProps } from './types';\nimport { castNativeType, makeMotionTime } from '~utils';\nimport { useTheme } from '~components/BladeProvider';\n\nconst useAnimatedTag = (\n  onAnimationEndCallback: () => void,\n): {\n  entering: ReanimatedKeyframe;\n  animate: () => void;\n  animatedStyle: {\n    maxWidth: `${number}%`;\n    opacity: number;\n  };\n} => {\n  const maxWidth = useSharedValue(TAG_MAX_WIDTH_START); // Initial max-width value\n  const opacity = useSharedValue(TAG_OPACITY_START); // Initial opacity value\n  const { theme } = useTheme();\n\n  const entering = new Keyframe({\n    0: {\n      opacity: TAG_OPACITY_END,\n    },\n    100: {\n      opacity: TAG_OPACITY_START,\n      easing: (theme.motion.easing.exit as unknown) as EasingFn,\n    },\n  }).duration(makeMotionTime(theme.motion.duration.xquick));\n\n  const animate = (): void => {\n    maxWidth.value = withTiming(\n      TAG_MAX_WIDTH_END,\n      {\n        duration: makeMotionTime(theme.motion.duration.xquick),\n        easing: castNativeType(theme.motion.easing.exit),\n      },\n      (isComplete) => {\n        if (isComplete) {\n          runOnJS(onAnimationEndCallback)();\n        }\n      },\n    );\n    opacity.value = withTiming(TAG_OPACITY_END, {\n      duration: makeMotionTime(theme.motion.duration.xquick),\n      easing: Easing.out(Easing.exp),\n    });\n  };\n\n  const animatedStyle = useAnimatedStyle(() => {\n    return {\n      maxWidth: maxWidth.value,\n      opacity: opacity.value,\n    };\n  });\n\n  return { animate, animatedStyle, entering };\n};\n\nconst AnimatedTag = ({\n  children,\n  currentTagIndex,\n  activeTagIndex,\n  onDismiss,\n  tagsLength,\n  isDisabled,\n}: AnimatedTagProps): React.ReactElement => {\n  const onAnimationEnd = (): void => {\n    onDismiss({ tagIndex: currentTagIndex, tagName: children });\n  };\n\n  const prevSelectionsLength = React.useRef<number>();\n  const { animate, animatedStyle, entering } = useAnimatedTag(onAnimationEnd);\n\n  const isTagRemoved = prevSelectionsLength.current\n    ? prevSelectionsLength.current > tagsLength\n    : false;\n\n  return (\n    <Animated.View style={animatedStyle} entering={isTagRemoved ? undefined : entering}>\n      <Tag\n        _isVirtuallyFocused={currentTagIndex === activeTagIndex}\n        _isTagInsideInput={true}\n        onDismiss={() => {\n          animate();\n        }}\n        marginRight=\"spacing.3\"\n        marginY=\"spacing.2\"\n        isDisabled={isDisabled}\n      >\n        {children}\n      </Tag>\n    </Animated.View>\n  );\n};\n\nexport { AnimatedTag };\n"],"names":["useAnimatedTag","onAnimationEndCallback","maxWidth","useSharedValue","TAG_MAX_WIDTH_START","opacity","TAG_OPACITY_START","_useTheme","useTheme","theme","entering","Keyframe","TAG_OPACITY_END","easing","motion","exit","duration","makeMotionTime","xquick","animate","value","withTiming","TAG_MAX_WIDTH_END","castNativeType","isComplete","runOnJS","Easing","out","exp","animatedStyle","useAnimatedStyle","AnimatedTag","_ref","children","currentTagIndex","activeTagIndex","onDismiss","tagsLength","isDisabled","onAnimationEnd","tagIndex","tagName","prevSelectionsLength","React","useRef","_useAnimatedTag","isTagRemoved","current","_jsx","Animated","View","style","undefined","Tag","_isVirtuallyFocused","_isTagInsideInput","marginRight","marginY"],"mappings":"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"}