{"version":3,"file":"AccordionButton.native.js","sources":["../../../../../src/components/Accordion/AccordionButton.native.tsx"],"sourcesContent":["import type { ReactElement } from 'react';\nimport { useEffect } from 'react';\nimport type { PressableProps } from 'react-native';\nimport { useAnimatedStyle, useSharedValue, withTiming } from 'react-native-reanimated';\nimport { StyledAccordionButton } from './StyledAccordionButton.native';\nimport type { AccordionButtonProps } from './types';\nimport { useAccordion } from './AccordionContext';\nimport { getBackgroundColor, getTransitionDuration, getTransitionEasing } from './commonStyles';\nimport { AccordionItemHeader } from './AccordionItemHeader';\nimport { Text } from '~components/Typography';\nimport { assignWithoutSideEffects } from '~utils/assignWithoutSideEffects';\nimport { MetaConstants, metaAttribute } from '~utils/metaAttribute';\nimport { castNativeType } from '~utils';\nimport { useCollapsible } from '~components/Collapsible/CollapsibleContext';\nimport BaseBox from '~components/Box/BaseBox';\nimport { useTheme } from '~components/BladeProvider';\nimport { makeAccessible } from '~utils/makeAccessible';\nimport { throwBladeError } from '~utils/logger';\n\nconst _AccordionButton = ({\n  index,\n  icon: Icon,\n  title,\n  isDeprecatedAPI,\n  isDisabled,\n  header,\n}: AccordionButtonProps): ReactElement => {\n  const { onExpandChange, isExpanded, collapsibleBodyId } = useCollapsible();\n  const { showNumberPrefix, expandedIndex } = useAccordion();\n  const { theme } = useTheme();\n\n  const toggleCollapse = (): void => onExpandChange(!isExpanded);\n  const isItemExpanded = expandedIndex === index;\n\n  const isPressed = useSharedValue(false);\n\n  const duration = castNativeType(getTransitionDuration(theme));\n  const easing = castNativeType(getTransitionEasing(theme));\n\n  const activeBackgroundColor = useSharedValue(getBackgroundColor({ theme, isActive: true }));\n  const inActiveBackgroundColor = useSharedValue(getBackgroundColor({ theme, isActive: false }));\n\n  /**\n   * `backgroundColor` is derived from `isExpanded` and pressed state.\n   *\n   * Since we can't directly access return values from JS functions (`getBackgroundColor`) on UI thread,\n   * this effect updates the shared values for active / inactive states which are used by `animatedStyles`.\n   */\n  useEffect(() => {\n    activeBackgroundColor.value = getBackgroundColor({ theme, isActive: true });\n    inActiveBackgroundColor.value = getBackgroundColor({ theme, isActive: false });\n  }, [activeBackgroundColor, inActiveBackgroundColor, theme]);\n\n  const animatedStyles = useAnimatedStyle(() => ({\n    backgroundColor: withTiming(\n      isPressed.value ? activeBackgroundColor.value : inActiveBackgroundColor.value,\n      {\n        duration,\n        easing,\n      },\n    ),\n  }));\n\n  const _showNumberPrefix = typeof index === 'number' && showNumberPrefix;\n\n  const _index = _showNumberPrefix ? (\n    <Text size=\"large\" weight=\"semibold\" marginRight=\"spacing.2\">\n      {index + 1}.\n    </Text>\n  ) : null;\n\n  const a11yLabel = _showNumberPrefix ? `${index + 1}. ${title}` : title;\n\n  const renderChildren: PressableProps['children'] = ({ pressed }) => {\n    isPressed.value = pressed;\n\n    const _icon = Icon && (\n      <Icon\n        size=\"medium\"\n        color=\"surface.icon.gray.normal\"\n        marginRight=\"spacing.3\"\n        marginY=\"spacing.2\"\n      />\n    );\n\n    if (__DEV__) {\n      if (_index && _icon) {\n        throwBladeError({\n          message: \"showNumberPrefix and icon shouldn't be used together\",\n          moduleName: 'Accordion',\n        });\n      }\n    }\n\n    return (\n      <BaseBox\n        display=\"flex\"\n        flexDirection=\"row\"\n        flex={1}\n        justifyContent=\"space-between\"\n        alignItems=\"center\"\n      >\n        {isDeprecatedAPI ? <AccordionItemHeader title={title} leading={_icon ?? _index} /> : header}\n      </BaseBox>\n    );\n  };\n\n  return (\n    <StyledAccordionButton\n      isExpanded={isExpanded}\n      onPress={toggleCollapse}\n      style={animatedStyles}\n      disabled={isDisabled}\n      {...makeAccessible({\n        role: 'button',\n        expanded: isItemExpanded,\n        controls: collapsibleBodyId,\n        label: a11yLabel,\n      })}\n      {...metaAttribute({ name: MetaConstants.AccordionButton })}\n    >\n      {renderChildren}\n    </StyledAccordionButton>\n  );\n};\n\nconst AccordionButton = assignWithoutSideEffects(_AccordionButton, {\n  componentId: MetaConstants.AccordionButton,\n});\n\nexport { AccordionButton };\n"],"names":["_AccordionButton","_ref","index","Icon","icon","title","isDeprecatedAPI","isDisabled","header","_useCollapsible","useCollapsible","onExpandChange","isExpanded","collapsibleBodyId","_useAccordion","useAccordion","showNumberPrefix","expandedIndex","_useTheme","useTheme","theme","toggleCollapse","isItemExpanded","isPressed","useSharedValue","duration","castNativeType","getTransitionDuration","easing","getTransitionEasing","activeBackgroundColor","getBackgroundColor","isActive","inActiveBackgroundColor","useEffect","value","animatedStyles","useAnimatedStyle","backgroundColor","withTiming","_showNumberPrefix","_index","_jsxs","Text","size","weight","marginRight","children","a11yLabel","renderChildren","_ref2","pressed","_icon","_jsx","color","marginY","__DEV__","throwBladeError","message","moduleName","BaseBox","display","flexDirection","flex","justifyContent","alignItems","AccordionItemHeader","leading","StyledAccordionButton","Object","assign","onPress","style","disabled","makeAccessible","role","expanded","controls","label","metaAttribute","name","MetaConstants","AccordionButton","assignWithoutSideEffects","componentId"],"mappings":"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"}