{"version":3,"file":"dropdownUtils.js","sources":["../../../../../src/components/Dropdown/dropdownUtils.ts"],"sourcesContent":["/*\n * This content is licensed according to the W3C Software License at\n * https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document\n *\n * This software or document includes material copied from or derived from\n * https://www.w3.org/WAI/ARIA/apg/example-index/combobox/combobox-select-only.html.\n * Copyright © 2022 W3C® (MIT, ERCIM, Keio, Beihang)\n */\n\nimport type { DropdownContextType, OptionsType } from './useDropdown';\nimport { dropdownComponentIds } from './dropdownComponentIds';\nimport type { SpacingValueType } from '~components/Box/BaseBox';\n\nexport type SelectActionsType =\n  | 'Close'\n  | 'CloseSelect'\n  | 'First'\n  | 'Last'\n  | 'Next'\n  | 'Open'\n  | 'PageDown'\n  | 'PageUp'\n  | 'Previous'\n  | 'Select'\n  | 'Type';\n\n// Save a list of named combobox actions, for future readability\nconst SelectActions: Record<SelectActionsType, SelectActionsType> = {\n  Close: 'Close',\n  CloseSelect: 'CloseSelect',\n  First: 'First',\n  Last: 'Last',\n  Next: 'Next',\n  Open: 'Open',\n  PageDown: 'PageDown',\n  PageUp: 'PageUp',\n  Previous: 'Previous',\n  Select: 'Select',\n  Type: 'Type',\n};\n\n/**\n * Filter an array of options against an input string\n * returns an array of options that begin with the filter string, case-independent\n *\n */\nexport function filterOptions(\n  options: string[] = [],\n  filter: string,\n  exclude: string[] = [],\n): string[] {\n  return options.filter((option) => {\n    const matches = String(option).toLowerCase().startsWith(filter.toLowerCase());\n    return matches && !exclude.includes(option);\n  });\n}\n\n/**\n * Map a keypress to action\n */\nexport function getActionFromKey(\n  e: React.MouseEvent<HTMLElement> | React.KeyboardEvent<HTMLElement>,\n  isOpen: boolean,\n  dropdownTriggerer: DropdownContextType['dropdownTriggerer'],\n): SelectActionsType | undefined {\n  if (!e) {\n    return undefined;\n  }\n\n  const { altKey, ctrlKey, metaKey } = e;\n  let key = '';\n  if ('key' in e) {\n    key = e.key;\n  }\n  const openKeys = ['ArrowDown', 'ArrowUp', 'Enter', ' ']; // all keys that will do the default open action\n  if (!key) return undefined;\n  // handle opening when closed\n  if (!isOpen && key && openKeys.includes(key)) {\n    return SelectActions.Open;\n  }\n\n  // home and end move the selected option when open or closed\n  if (key === 'Home') {\n    return SelectActions.First;\n  }\n  if (key === 'End') {\n    return SelectActions.Last;\n  }\n\n  // handle typing characters when open or closed\n  if (\n    key === 'Backspace' ||\n    key === 'Clear' ||\n    (key.length === 1 && key !== ' ' && !altKey && !ctrlKey && !metaKey)\n  ) {\n    return SelectActions.Type;\n  }\n\n  // handle keys when open\n  if (isOpen) {\n    if (key === 'ArrowUp' && altKey) {\n      return SelectActions.CloseSelect;\n    } else if (key === 'ArrowDown' && !altKey) {\n      return SelectActions.Next;\n    } else if (key === 'ArrowUp') {\n      return SelectActions.Previous;\n    } else if (key === 'PageUp') {\n      return SelectActions.PageUp;\n    } else if (key === 'PageDown') {\n      return SelectActions.PageDown;\n    } else if (key === 'Escape') {\n      return SelectActions.Close;\n    } else if (\n      key === 'Enter' ||\n      // we ignore the spacebar select in autocomplete since hitting spacebar might be expected while typing\n      (dropdownTriggerer !== dropdownComponentIds.triggers.AutoComplete &&\n        dropdownTriggerer !== dropdownComponentIds.triggers.SearchInput &&\n        key === ' ')\n    ) {\n      return SelectActions.CloseSelect;\n    }\n  }\n\n  return undefined;\n}\n\n/**\n * Return the index of an option from an array of options, based on a search string\n *\n * if the filter is multiple iterations of the same letter (e.g \"aaa\"), then cycle through first-letter matches\n **/\nexport function getIndexByLetter(options: string[], filter: string, startIndex = 0): number {\n  const orderedOptions = [...options.slice(startIndex), ...options.slice(0, startIndex)];\n  const firstMatch = filterOptions(orderedOptions, filter)[0];\n  const allSameLetter = (array: string[]): boolean => array.every((letter) => letter === array[0]);\n\n  // first check if there is an exact match for the typed string\n  if (firstMatch) {\n    return options.indexOf(firstMatch);\n  }\n\n  // if the same letter is being repeated, cycle through first-letter matches\n  else if (allSameLetter(filter.split(''))) {\n    const matches = filterOptions(orderedOptions, filter[0]);\n    return options.indexOf(matches[0]);\n  }\n\n  // if no matches, return -1\n  else {\n    return -1;\n  }\n}\n\n/**\n * This functions makes sure the optionsIndex is not going out of possible options\n */\nexport function getUpdatedIndex({\n  currentIndex,\n  maxIndex,\n  actionType,\n}: {\n  currentIndex: number;\n  maxIndex: number;\n  actionType: SelectActionsType;\n}): number {\n  // On PageUP or PageDown, we jump focus by 10 items or to the first or last element\n  // Details: https://www.w3.org/WAI/ARIA/apg/example-index/combobox/combobox-select-only.html#:~:text=PageUp,to%20last%20option).\n  const pageSize = 10;\n\n  switch (actionType) {\n    case SelectActions.First:\n      return 0;\n    case SelectActions.Last:\n      return maxIndex;\n    case SelectActions.Previous:\n      return Math.max(0, currentIndex - 1);\n    case SelectActions.Next:\n      return Math.min(maxIndex, currentIndex + 1);\n    case SelectActions.PageUp:\n      return Math.max(0, currentIndex - pageSize);\n    case SelectActions.PageDown:\n      return Math.min(maxIndex, currentIndex + pageSize);\n    default:\n      return currentIndex;\n  }\n}\n\n/**\n * Checks if the given HTML element is visible on screen\n */\nexport function isElementVisibleOnScreen(element: HTMLElement): boolean {\n  const bounding = element.getBoundingClientRect();\n\n  return (\n    bounding.top >= 0 &&\n    bounding.left >= 0 &&\n    bounding.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n    bounding.right <= (window.innerWidth || document.documentElement.clientWidth)\n  );\n}\n\n/**\n * Checks if element is visible inside the given container\n */\nfunction isElementVisible(container: HTMLElement, element: HTMLElement): boolean {\n  const containerRect = container.getBoundingClientRect();\n  const elementRect = element.getBoundingClientRect();\n\n  const isVerticalVisible =\n    elementRect.top >= containerRect.top && elementRect.bottom <= containerRect.bottom;\n\n  return isVerticalVisible;\n}\n\n/**\n * Checks if the dropdown is scrollable\n */\nexport function isScrollable(element: HTMLElement): boolean {\n  return element && element.clientHeight < element.scrollHeight;\n}\n\ntype ActionsType = {\n  setIsOpen: DropdownContextType['setIsOpen'];\n  close: DropdownContextType['close'];\n  selectCurrentOption: () => void;\n  onOptionChange: (action: SelectActionsType) => void;\n  onComboType: (letter: string, action: SelectActionsType) => void;\n};\n/**\n * Performs the action when actionType is passed\n *\n * This function handles all the keydown actions.\n */\nexport const performAction = (\n  action: SelectActionsType,\n  payload: {\n    event: React.KeyboardEvent<HTMLInputElement | HTMLButtonElement>;\n  },\n  actions: ActionsType,\n): boolean => {\n  const { event } = payload;\n\n  switch (action) {\n    case SelectActions.Last:\n    // @ts-expect-error: intentional fallthrough, ignoring the warning\n    case SelectActions.First:\n      actions.setIsOpen(true);\n    // intentional fallthrough\n    case SelectActions.Next:\n    case SelectActions.Previous:\n    case SelectActions.PageUp:\n    case SelectActions.PageDown:\n      event.preventDefault();\n      actions.onOptionChange(action);\n      return true;\n    case SelectActions.CloseSelect:\n      event.preventDefault();\n      actions.selectCurrentOption();\n      return true;\n    case SelectActions.Close:\n      event.preventDefault();\n      actions.close();\n      return true;\n    case SelectActions.Type:\n      actions.onComboType(event.key, action);\n      return true;\n    case SelectActions.Open:\n      event.preventDefault();\n      actions.setIsOpen(true);\n      return true;\n\n    default:\n      break;\n  }\n\n  return false;\n};\n\n/**\n * When options list is large, it can have a scrollbar.\n *\n * This function ensures the active option is always in the viewport\n */\nexport const ensureScrollVisiblity = (\n  newActiveIndex: number,\n  containerElement: HTMLElement | null,\n  options: string[],\n): void => {\n  // ensure the new option is in view\n  if (containerElement) {\n    if (isScrollable(containerElement)) {\n      const optionEl = containerElement.querySelectorAll<HTMLElement>(\n        '[role=\"option\"], [role=\"menuitem\"]',\n      );\n      // Making sure its the same element as the one from options state\n      if (\n        newActiveIndex >= 0 &&\n        optionEl[newActiveIndex].dataset.value === options[newActiveIndex]\n      ) {\n        const activeElement = optionEl[newActiveIndex];\n\n        if (!isElementVisible(containerElement, activeElement)) {\n          activeElement.scrollIntoView({ inline: 'nearest' });\n        }\n\n        if (!isElementVisibleOnScreen(optionEl[newActiveIndex])) {\n          activeElement.scrollIntoView({ behavior: 'smooth' });\n        }\n      }\n    }\n  }\n};\n\n/**\n * value that is set in the actual form input\n */\nexport const makeInputValue = (selectedIndices: number[], options: OptionsType): string => {\n  if (options.length === 0) {\n    return '';\n  }\n  return selectedIndices.map((selectedIndex) => options[selectedIndex]?.value).join(', ');\n};\n\n/**\n * Value that is displayed inside the select field\n */\nexport const makeInputDisplayValue = (selectedIndices: number[], options: OptionsType): string => {\n  // When no item is selected or no item is present\n  if (options.length === 0 || selectedIndices.length === 0) {\n    return '';\n  }\n\n  // When one item is selected, we display that item's title in input\n  if (selectedIndices.length === 1) {\n    return options[selectedIndices[0]]?.title;\n  }\n\n  // When more than one item is selected, we display the count of items\n  return `${selectedIndices.length} items selected`;\n};\n\nexport type DropdownPosition = {\n  top?: SpacingValueType;\n  bottom?: SpacingValueType;\n  left?: SpacingValueType;\n  right?: SpacingValueType;\n};\n"],"names":["SelectActions","Close","CloseSelect","First","Last","Next","Open","PageDown","PageUp","Previous","Select","Type","filterOptions","options","arguments","length","undefined","filter","exclude","option","matches","String","toLowerCase","startsWith","includes","getActionFromKey","e","isOpen","dropdownTriggerer","altKey","ctrlKey","metaKey","key","openKeys","dropdownComponentIds","triggers","AutoComplete","SearchInput","getIndexByLetter","startIndex","orderedOptions","concat","_toConsumableArray","slice","firstMatch","allSameLetter","array","every","letter","indexOf","split","getUpdatedIndex","_ref","currentIndex","maxIndex","actionType","pageSize","Math","max","min","isElementVisibleOnScreen","element","bounding","getBoundingClientRect","top","left","bottom","window","innerHeight","document","documentElement","clientHeight","right","innerWidth","clientWidth","isElementVisible","container","containerRect","elementRect","isVerticalVisible","isScrollable","scrollHeight","performAction","action","payload","actions","event","setIsOpen","preventDefault","onOptionChange","selectCurrentOption","close","onComboType","ensureScrollVisiblity","newActiveIndex","containerElement","optionEl","querySelectorAll","dataset","value","activeElement","scrollIntoView","inline","behavior","makeInputValue","selectedIndices","map","selectedIndex","_options$selectedInde","join","makeInputDisplayValue","_options$selectedIndi","title"],"mappings":"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"}