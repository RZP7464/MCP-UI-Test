{"version":3,"file":"useCheckbox.js","sources":["../../../../../src/components/Checkbox/useCheckbox.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/explicit-function-return-type */\n/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\nimport React from 'react';\nimport type { GestureResponderEvent } from 'react-native';\nimport type { CheckboxProps } from './Checkbox';\nimport { useFormId } from '~components/Form/useFormId';\nimport { makeAccessible } from '~utils/makeAccessible';\nimport { getPlatformType } from '~utils';\nimport { useControllableState } from '~utils/useControllable';\nimport { throwBladeError } from '~utils/logger';\n\ntype UseCheckboxProps = Pick<\n  CheckboxProps,\n  | 'isChecked'\n  | 'defaultChecked'\n  | 'isDisabled'\n  | 'isIndeterminate'\n  | 'isRequired'\n  | 'onChange'\n  | 'name'\n  | 'value'\n> & {\n  role?: 'checkbox' | 'switch';\n  hasError?: boolean;\n  hasHelperText?: boolean;\n};\n\n/**\n * indeterminate is not a HTML input element prop,\n * it's an IDL prop thus we need to set it on the underlying HTMLInputElement\n */\nfunction setMixed(element: HTMLInputElement, mixed?: boolean) {\n  if (mixed) {\n    element.indeterminate = true;\n  } else if (element.indeterminate) {\n    element.indeterminate = false;\n  }\n}\n\nconst useCheckbox = ({\n  role = 'checkbox',\n  isChecked,\n  defaultChecked,\n  isIndeterminate,\n  isDisabled,\n  isRequired,\n  hasError,\n  hasHelperText,\n  onChange,\n  name,\n  value,\n}: UseCheckboxProps) => {\n  const inputRef = React.useRef<HTMLInputElement>(null);\n\n  const isReactNative = getPlatformType() === 'react-native';\n  if (__DEV__) {\n    if (isChecked && defaultChecked) {\n      throwBladeError({\n        message: `Do not provide both 'isChecked' and 'defaultChecked' to useCheckbox. Consider if you want this component to be controlled or uncontrolled.`,\n        moduleName: 'useCheckbox',\n      });\n    }\n  }\n\n  const [checkboxState, setCheckboxStateChange] = useControllableState({\n    value: isChecked,\n    defaultValue: defaultChecked ?? false,\n  });\n\n  const handleOnChange = (event: React.ChangeEvent<HTMLInputElement> | GestureResponderEvent) => {\n    if (isDisabled) {\n      event.stopPropagation();\n      event.preventDefault();\n      return;\n    }\n    setCheckboxStateChange((checked) => {\n      onChange?.({\n        isChecked: !checked,\n        event: event as React.ChangeEvent,\n        value,\n      });\n      return !checked;\n    });\n  };\n\n  // set indeterminate to input\n  React.useEffect(() => {\n    const element = inputRef.current;\n    if (!element) return;\n    setMixed(element, isIndeterminate);\n  }, [isIndeterminate]);\n\n  const state = {\n    isReactNative,\n    isChecked: checkboxState,\n    setChecked: setCheckboxStateChange,\n  };\n\n  const { inputId, errorTextId, helpTextId } = useFormId('checkbox');\n\n  const accessibilityProps = makeAccessible({\n    role,\n    required: Boolean(isRequired),\n    invalid: Boolean(hasError),\n    disabled: Boolean(isDisabled),\n    checked: inputRef.current?.indeterminate ? 'mixed' : checkboxState,\n    ...(hasError ? { errorMessage: errorTextId } : {}),\n    ...(hasHelperText ? { describedBy: helpTextId } : {}),\n  });\n\n  if (isReactNative) {\n    return {\n      state,\n      inputProps: {\n        onPress: handleOnChange,\n        name,\n        value,\n        ...accessibilityProps,\n      },\n    };\n  }\n\n  return {\n    state,\n    ids: { inputId, errorTextId, helpTextId },\n    inputProps: {\n      ref: inputRef,\n      onChange: handleOnChange,\n      type: 'checkbox',\n      name,\n      value,\n      checked: checkboxState,\n      disabled: isDisabled,\n      required: isRequired,\n      ...accessibilityProps,\n    },\n  };\n};\n\nexport type InputProps = ReturnType<typeof useCheckbox>['inputProps'];\n\nexport { useCheckbox };\n"],"names":["setMixed","element","mixed","indeterminate","useCheckbox","_ref","_inputRef$current","_ref$role","role","isChecked","defaultChecked","isIndeterminate","isDisabled","isRequired","hasError","hasHelperText","onChange","name","value","inputRef","React","useRef","isReactNative","getPlatformType","__DEV__","throwBladeError","message","moduleName","_useControllableState","useControllableState","defaultValue","_useControllableState2","_slicedToArray","checkboxState","setCheckboxStateChange","handleOnChange","event","stopPropagation","preventDefault","checked","useEffect","current","state","setChecked","_useFormId","useFormId","inputId","errorTextId","helpTextId","accessibilityProps","makeAccessible","Object","assign","required","Boolean","invalid","disabled","errorMessage","describedBy","inputProps","onPress","ids","ref","type"],"mappings":"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"}