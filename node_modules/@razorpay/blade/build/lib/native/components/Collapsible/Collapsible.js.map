{"version":3,"file":"Collapsible.js","sources":["../../../../../src/components/Collapsible/Collapsible.tsx"],"sourcesContent":["import type { ReactElement, ReactNode } from 'react';\nimport { Children, useCallback, useRef, useState, useMemo, forwardRef } from 'react';\n\nimport type { CollapsibleContextState } from './CollapsibleContext';\nimport { CollapsibleContext } from './CollapsibleContext';\nimport { MAX_WIDTH, MAX_WIDTH_NO_RESTRICTIONS } from './styles';\nimport { componentIds } from './componentIds';\nimport BaseBox from '~components/Box/BaseBox';\nimport type { DataAnalyticsAttribute, BladeElementRef, TestID } from '~utils/types';\nimport type { StyledPropsBlade } from '~components/Box/styledProps';\nimport { getStyledProps } from '~components/Box/styledProps';\nimport type { BoxProps } from '~components/Box';\nimport { makeSize } from '~utils';\nimport { size } from '~tokens/global';\nimport { metaAttribute, MetaConstants } from '~utils/metaAttribute';\nimport { useId } from '~utils/useId';\nimport { isValidAllowedChildren } from '~utils/isValidAllowedChildren';\nimport { throwBladeError } from '~utils/logger';\nimport { makeAnalyticsAttribute } from '~utils/makeAnalyticsAttribute';\nimport { assignWithoutSideEffects } from '~utils/assignWithoutSideEffects';\n\ntype CollapsibleProps = {\n  /**\n   * Composes `CollapsibleButton`, `CollapsibleLink`, `CollapsibleBody`\n   */\n  children: ReactNode;\n\n  /**\n   * Direction in which the content expands\n   *\n   * @default bottom\n   */\n  direction?: 'bottom' | 'top';\n\n  /**\n   * Expands the collapsible content by default (uncontrolled)\n   *\n   * @default false\n   */\n  defaultIsExpanded?: boolean;\n\n  /**\n   * Expands the collapsible content (controlled)\n   *\n   * @default undefined\n   */\n  isExpanded?: boolean;\n\n  /**\n   * Callback for change in collapsible's expanded state\n   *\n   * @default undefined\n   */\n  onExpandChange?: ({ isExpanded }: { isExpanded: boolean }) => void;\n\n  /**\n   * **Internal**: disables trigger validations. Used for AccordionButton and SideNavLink internally\n   */\n  _dangerouslyDisableValidations?: boolean;\n  /**\n   * **Internal**: used to override responsive width restrictions\n   */\n  _shouldApplyWidthRestrictions?: boolean;\n} & TestID &\n  DataAnalyticsAttribute &\n  StyledPropsBlade;\n\nconst MIN_WIDTH: BoxProps['minWidth'] = makeSize(size[200]);\n\nconst _Collapsible = (\n  {\n    children,\n    direction = 'bottom',\n    defaultIsExpanded = false,\n    isExpanded,\n    onExpandChange,\n    testID,\n    _shouldApplyWidthRestrictions = true,\n    _dangerouslyDisableValidations = false,\n    ...rest\n  }: CollapsibleProps,\n  ref: React.Ref<BladeElementRef>,\n): ReactElement => {\n  const [isBodyExpanded, setIsBodyExpanded] = useState(isExpanded ?? defaultIsExpanded);\n  const collapsibleBodyId = useId(MetaConstants.CollapsibleBody);\n\n  /**\n   * Maintain a ref to the initial value of `defaultExpanded || isExpanded` so changing it has no effect.\n   * This will help in determining the correct initial height of collapsing body content\n   */\n  const initialDefaultExpanded = useRef(Boolean(defaultIsExpanded || isExpanded));\n\n  const handleExpandChange = useCallback(\n    (nextIsExpanded: boolean) => {\n      if (typeof isExpanded !== 'undefined') {\n        // controlled\n        onExpandChange?.({ isExpanded: nextIsExpanded });\n      } else {\n        // uncontrolled\n        setIsBodyExpanded(nextIsExpanded);\n        onExpandChange?.({ isExpanded: nextIsExpanded });\n      }\n    },\n    [onExpandChange, isExpanded],\n  );\n\n  const contextValue = useMemo<CollapsibleContextState>(\n    () => ({\n      // controlled behavior if isExpanded is provided\n      isExpanded: isExpanded ?? isBodyExpanded,\n      onExpandChange: handleExpandChange,\n      defaultIsExpanded: initialDefaultExpanded.current,\n      direction,\n      collapsibleBodyId,\n    }),\n    [isBodyExpanded, direction, handleExpandChange, isExpanded, collapsibleBodyId],\n  );\n\n  if (__DEV__) {\n    Children.forEach(children, (child) => {\n      if (\n        !(\n          isValidAllowedChildren(child, componentIds.CollapsibleBody) ||\n          isValidAllowedChildren(child, componentIds.CollapsibleButton) ||\n          isValidAllowedChildren(child, componentIds.CollapsibleLink)\n        ) &&\n        !_dangerouslyDisableValidations\n      ) {\n        throwBladeError({\n          message: `only the following are supported as valid children: CollapsibleBody, CollapsibleButton, CollapsibleLink`,\n          moduleName: 'Collapsible',\n        });\n      }\n    });\n  }\n\n  return (\n    <CollapsibleContext.Provider value={contextValue}>\n      <BaseBox\n        ref={ref as never}\n        {...metaAttribute({ name: MetaConstants.Collapsible, testID })}\n        {...getStyledProps(rest)}\n        {...makeAnalyticsAttribute(rest)}\n      >\n        <BaseBox\n          display=\"flex\"\n          flexDirection={direction === 'bottom' ? 'column' : 'column-reverse'}\n          alignItems=\"flex-start\"\n          minWidth={_shouldApplyWidthRestrictions ? MIN_WIDTH : makeSize(size[0])}\n          maxWidth={_shouldApplyWidthRestrictions ? MAX_WIDTH : MAX_WIDTH_NO_RESTRICTIONS}\n        >\n          {children}\n        </BaseBox>\n      </BaseBox>\n    </CollapsibleContext.Provider>\n  );\n};\n\nconst Collapsible = assignWithoutSideEffects(forwardRef(_Collapsible), {\n  componentId: componentIds.Collapsible,\n});\n\nexport type { CollapsibleProps };\nexport { Collapsible };\n"],"names":["MIN_WIDTH","makeSize","size","_Collapsible","_ref","ref","children","_ref$direction","direction","_ref$defaultIsExpande","defaultIsExpanded","isExpanded","onExpandChange","testID","_ref$_shouldApplyWidt","_shouldApplyWidthRestrictions","_ref$_dangerouslyDisa","_dangerouslyDisableValidations","rest","_objectWithoutProperties","_excluded","_useState","useState","_useState2","_slicedToArray","isBodyExpanded","setIsBodyExpanded","collapsibleBodyId","useId","MetaConstants","CollapsibleBody","initialDefaultExpanded","useRef","Boolean","handleExpandChange","useCallback","nextIsExpanded","contextValue","useMemo","current","__DEV__","Children","forEach","child","isValidAllowedChildren","componentIds","CollapsibleButton","CollapsibleLink","throwBladeError","message","moduleName","_jsx","CollapsibleContext","Provider","value","BaseBox","Object","assign","metaAttribute","name","Collapsible","getStyledProps","makeAnalyticsAttribute","display","flexDirection","alignItems","minWidth","maxWidth","MAX_WIDTH","MAX_WIDTH_NO_RESTRICTIONS","assignWithoutSideEffects","forwardRef","componentId"],"mappings":"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"}